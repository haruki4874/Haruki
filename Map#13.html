<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ˜çµå°éšŠ_é›»å­åœ°åœ– - å¤šåŠŸèƒ½äº’å‹•åœ°åœ–ç³»çµ±</title>
    <meta name="description" content="åœ˜çµå°éšŠé›»å­åœ°åœ–ç³»çµ±ï¼Œæ”¯æ´å¤šç¨®åœ°åœ–åˆ‡æ›ã€åœ°é»æ¨™è¨˜ã€è·¯å¾‘ç¹ªè£½å’Œè³‡æ–™å°å‡ºåŠŸèƒ½">
    <meta name="keywords" content="é›»å­åœ°åœ–, åœ°åœ–ç³»çµ±, è·¯å¾‘è¦åŠƒ, åœ°é»æ¨™è¨˜, åœ˜çµå°éšŠ">
    <meta name="author" content="åœ˜çµå°éšŠ - Haruki.N">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://unity-team-map.netlify.app/">
    <meta property="og:title" content="åœ˜çµå°éšŠé›»å­åœ°åœ–ç³»çµ±">
    <meta property="og:description" content="å¤šåŠŸèƒ½äº’å‹•é›»å­åœ°åœ–ç³»çµ±ï¼Œæ”¯æ´å¤šç¨®åœ°åœ–é¡å‹ã€åœ°é»ç®¡ç†å’Œè·¯å¾‘è¦åŠƒ">
    <meta property="og:image" content="https://images.unsplash.com/photo-1526778548025-fa2f459cd5c1">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://unity-team-map.netlify.app/">
    <meta property="twitter:title" content="åœ˜çµå°éšŠé›»å­åœ°åœ–ç³»çµ±">
    <meta property="twitter:description" content="å¤šåŠŸèƒ½äº’å‹•é›»å­åœ°åœ–ç³»çµ±ï¼Œæ”¯æ´å¤šç¨®åœ°åœ–é¡å‹ã€åœ°é»ç®¡ç†å’Œè·¯å¾‘è¦åŠƒ">
    <meta property="twitter:image" content="https://images.unsplash.com/photo-1526778548025-fa2f459cd5c1">
    
    <!-- Leaflet CSS & JS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- LZ-String Compression Library -->
    <script src="https://cdn.jsdelivr.net/npm/lz-string@1.5.0/libs/lz-string.min.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Segoe+UI:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Google Maps API (åƒ…åœ¨éœ€è¦æ™‚åŠ è¼‰) -->
    <script>
      function loadGoogleMaps() {
        const script = document.createElement('script');
        script.src = 'https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY&callback=initGoogleMap';
        script.async = true;
        script.defer = true;
        document.head.appendChild(script);
      }
    </script>
    
    <style>
        /* ==================== ç²¾ç°¡ç‰ˆCSSè®Šæ•¸å®šç¾© ==================== */
        :root {
            /* ä¸»è‰²èª¿ */
            --primary-color: #392682;
            --secondary-color: #75A3C9;
            --accent-color: #3498db;
            --danger-color: #e74c3c;
            --success-color: #2ecc71;
            --warning-color: #f39c12;
            --purple-color: #9b59b6;
            
            /* ä¸­æ€§è‰² */
            --light-bg: #f5f7fa;
            --dark-text: #2c3e50;
            --medium-text: #555;
            --light-text: #7f8c8d;
            --border-color: #e0e0e0;
            --card-bg: #ffffff;
            --hover-bg: #f8f9fa;
            
            /* å°ºå¯¸è®Šæ•¸ */
            --border-radius: 10px;
            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --hover-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
            --transition-speed: 0.3s;
            
            /* å­—é«” */
            --font-main: 'Segoe UI', 'Noto Sans TC', sans-serif;
            --font-mono: 'Courier New', monospace;
        }
        
        /* ==================== åŸºç¤æ¨£å¼é‡ç½® ==================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font-main);
            background: linear-gradient(135deg, var(--light-bg) 0%, #e3f2fd 100%);
            color: var(--dark-text);
            min-height: 100vh;
            line-height: 1.6;
            transition: background 0.5s ease;
        }
        
        /* ==================== å®¹å™¨èˆ‡ä½ˆå±€ ==================== */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            transition: all var(--transition-speed) ease;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 25px 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 800;
            letter-spacing: 1px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.5;
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            min-height: 650px;
        }
        
        /* ==================== åœ°åœ–å€åŸŸ ==================== */
        .map-section {
            flex: 3;
            min-width: 300px;
            padding: 20px;
            position: relative;
        }
        
        #map {
            height: 650px;
            width: 100%;
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            z-index: 1;
            border: 1px solid var(--border-color);
        }
        
        .map-controls {
            position: absolute;
            top: 30px;
            right: 30px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        /* ==================== è³‡è¨Šå€åŸŸ ==================== */
        .info-section {
            flex: 2;
            min-width: 300px;
            padding: 20px;
            background-color: #f9f9f9;
            border-left: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .tab-container {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border-color);
            overflow-x: auto;
        }
        
        .tab-container::-webkit-scrollbar {
            display: none;
        }
        
        .tab {
            padding: 12px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 600;
            color: var(--light-text);
            border-bottom: 3px solid transparent;
            transition: all var(--transition-speed);
            font-size: 14px;
            white-space: nowrap;
        }
        
        .tab.active {
            color: var(--accent-color);
            border-bottom: 3px solid var(--accent-color);
        }
        
        .tab-content {
            flex: 1;
            overflow-y: auto;
            max-height: 490px;
            padding-right: 5px;
        }
        
        .tab-content::-webkit-scrollbar {
            width: 6px;
        }
        
        .tab-content::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }
        
        .tab-content::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }
        
        .tab-pane {
            display: none;
        }
        
        .tab-pane.active {
            display: block;
        }
        
        /* ==================== åœ°é»å¡ç‰‡ ==================== */
        .location-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 16px;
            margin-bottom: 16px;
            box-shadow: var(--card-shadow);
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            border-left: 4px solid var(--primary-color);
        }
        
        .location-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--hover-shadow);
        }
        
        .location-card.active {
            border-left-color: var(--accent-color);
            background-color: #f0f8ff;
        }
        
        .location-title {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }
        
        .location-name {
            font-size: 16px;
            font-weight: 700;
            color: var(--dark-text);
            line-height: 1.3;
        }
        
        .location-date {
            font-size: 12px;
            color: var(--light-text);
            background: var(--hover-bg);
            padding: 3px 8px;
            border-radius: 12px;
        }
        
        .location-img {
            width: 100%;
            height: 180px;
            object-fit: cover;
            border-radius: 8px;
            margin: 12px 0;
            border: 1px solid var(--border-color);
            transition: transform var(--transition-speed);
        }
        
        .location-card:hover .location-img {
            transform: scale(1.02);
        }
        
       .location-desc {
    color: var(--medium-text);
    line-height: 1.5;
    font-size: 14px;
    margin-bottom: 8px;
    
    /* æ¨™æº–å±¬æ€§ - ç¾ä»£ç€è¦½å™¨ */
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    
    /* Firefox å…¼å®¹æ€§ */
    display: -moz-box;
    -moz-line-clamp: 3;
    -moz-box-orient: vertical;
    
    /* IE/Edge èˆŠç‰ˆå…¼å®¹æ€§ */
    display: -ms-flexbox;
    -ms-line-clamp: 3;
    -ms-box-orient: vertical;
    
    /* æ¨™æº–å±¬æ€§ */
    display: flex;
    line-clamp: 3;
    box-orient: vertical;
    
    /* é€šç”¨å±¬æ€§ */
    overflow: hidden;
    text-overflow: ellipsis;
    
    /* å‚™ç”¨æ–¹æ¡ˆï¼šä½¿ç”¨ max-height å’Œæ¼¸è®Šé®ç½© */
    max-height: 4.5em; /* 3è¡Œ * 1.5è¡Œé«˜ */
}

/* å°æ–¼ä¸æ”¯æ´ line-clamp çš„ç€è¦½å™¨ï¼Œæä¾›å‚™ç”¨æ¨£å¼ */
@supports not ((-webkit-line-clamp: 3) or (line-clamp: 3)) {
    .location-desc {
        position: relative;
        max-height: 4.5em;
        overflow: hidden;
    }
    
    .location-desc::after {
        content: '...';
        position: absolute;
        bottom: 0;
        right: 0;
        padding-left: 8px;
        background: linear-gradient(to right, transparent, var(--card-bg) 50%);
    }
}

/* ç¢ºä¿å¡ç‰‡å…§åœ–ç‰‡ä¸æœƒå½±éŸ¿ä½ˆå±€ */
.location-card {
    position: relative;
    overflow: hidden;
}

/* ä¿®æ­£å…¶ä»–å¯èƒ½çš„å¤šè¡Œæ–‡æœ¬æˆªæ–·å•é¡Œ */
.timeline-content,
.member-tasks,
.project-desc {
    /* æ¨™æº–å±¬æ€§ */
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    
    /* Firefox å…¼å®¹æ€§ */
    display: -moz-box;
    -moz-line-clamp: 2;
    -moz-box-orient: vertical;
    
    /* IE/Edge èˆŠç‰ˆå…¼å®¹æ€§ */
    display: -ms-flexbox;
    -ms-line-clamp: 2;
    -ms-box-orient: vertical;
    
    /* æ¨™æº–å±¬æ€§ */
    display: flex;
    line-clamp: 2;
    box-orient: vertical;
    
    overflow: hidden;
    text-overflow: ellipsis;
}

/* å–®è¡Œæ–‡æœ¬æˆªæ–· */
.location-name,
.provider-name,
.timeline-date {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 100%;
}

/* éŸ¿æ‡‰å¼è¨­è¨ˆä¸­çš„å¤šè¡Œæ–‡æœ¬è™•ç† */
@media (max-width: 768px) {
    .location-desc {
        /* ç§»å‹•ç«¯æ¸›å°‘é¡¯ç¤ºè¡Œæ•¸ */
        -webkit-line-clamp: 2;
        -moz-line-clamp: 2;
        -ms-line-clamp: 2;
        line-clamp: 2;
        max-height: 3em;
    }
    
    .member-tasks,
    .project-desc {
        -webkit-line-clamp: 1;
        -moz-line-clamp: 1;
        -ms-line-clamp: 1;
        line-clamp: 1;
        max-height: 1.5em;
    }
}

/* æ‰“å°æ¨£å¼ */
@media print {
    .location-desc {
        /* æ‰“å°æ™‚é¡¯ç¤ºå…¨éƒ¨å…§å®¹ */
        -webkit-line-clamp: unset;
        -moz-line-clamp: unset;
        -ms-line-clamp: unset;
        line-clamp: unset;
        max-height: none;
        overflow: visible;
    }
}

/* ç‚ºèˆŠç‰ˆç€è¦½å™¨æ·»åŠ å‚™ç”¨æ–¹æ¡ˆ */
.no-lineclamp .location-desc {
    position: relative;
    max-height: 4.5em;
    overflow: hidden;
}

.no-lineclamp .location-desc::after {
    content: '...';
    position: absolute;
    bottom: 0;
    right: 0;
    padding-left: 8px;
    background: linear-gradient(to right, transparent, var(--card-bg) 50%);
}
        
        .location-coords {
            font-size: 12px;
            color: var(--light-text);
            font-family: var(--font-mono);
            background: var(--hover-bg);
            padding: 4px 8px;
            border-radius: 6px;
            display: inline-block;
        }
        
        .card-actions {
            display: flex;
            justify-content: flex-end;
            gap: 8px;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid var(--border-color);
        }
        
        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all var(--transition-speed);
        }
        
        .edit-btn {
            background-color: var(--accent-color);
            color: white;
        }
        
        .edit-btn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        
        .delete-btn {
            background-color: var(--danger-color);
            color: white;
        }
        
        .delete-btn:hover {
            background-color: #c0392b;
            transform: translateY(-2px);
        }
        
        /* ==================== æœå°‹æ¡† ==================== */
        .search-box {
            margin-bottom: 20px;
            position: relative;
        }
        
        .search-box input {
            width: 100%;
            padding: 14px 20px 14px 45px;
            border: 2px solid var(--border-color);
            border-radius: 50px;
            font-size: 14px;
            transition: all var(--transition-speed);
            background: var(--card-bg);
        }
        
        .search-box input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        .search-box::before {
            content: 'ğŸ”';
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 16px;
            color: var(--light-text);
        }
        
        /* ==================== æŒ‰éˆ•æ¨£å¼ ==================== */
        .btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, var(--accent-color), #2980b9);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all var(--transition-speed) ease;
            font-size: 14px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.3);
        }
        
        .btn:active {
            transform: translateY(-1px);
        }
        
        .btn-small {
            padding: 8px 16px;
            font-size: 13px;
        }
        
        .btn-reset {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
        }
        
        .btn-path {
            background: linear-gradient(135deg, var(--success-color), #27ae60);
        }
        
        .btn-cancel {
            background: linear-gradient(135deg, var(--danger-color), #c0392b);
        }
        
        .btn-picker {
            background: linear-gradient(135deg, var(--purple-color), #8e44ad);
        }
        
        .btn-export {
            background: linear-gradient(135deg, #1abc9c, #16a085);
        }
        
        .btn-arrow {
            background: linear-gradient(135deg, #e67e22, #d35400);
        }
        
        /* ==================== æ§åˆ¶é¢æ¿ ==================== */
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            padding: 20px;
            background-color: #f8fafc;
            border-top: 1px solid var(--border-color);
        }
        
        /* ==================== åœ°åœ–æä¾›å•†å¡ç‰‡ ==================== */
        .map-providers {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .provider-card {
            background: var(--card-bg);
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            cursor: pointer;
            transition: all var(--transition-speed);
            border: 2px solid transparent;
            text-align: center;
        }
        
        .provider-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--hover-shadow);
        }
        
        .provider-card.active {
            border-color: var(--accent-color);
            background-color: #f0f8ff;
        }
        
        .provider-name {
            font-weight: 700;
            color: var(--dark-text);
            margin-bottom: 8px;
            font-size: 16px;
        }
        
        .provider-desc {
            font-size: 13px;
            color: var(--light-text);
            line-height: 1.4;
        }
        
        /* ==================== é è…³ ==================== */
        footer {
            text-align: center;
            padding: 20px;
            color: var(--light-text);
            font-size: 14px;
            border-top: 1px solid var(--border-color);
            background: #f8fafc;
        }
        
        /* ==================== è·¯å¾‘é è¦½é¢æ¿ ==================== */
        .path-preview-panel {
            position: absolute;
            top: 100px;
            right: 30px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            max-width: 300px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(52, 152, 219, 0.1);
            display: none;
        }
        
        .path-preview-title {
            font-weight: bold;
            color: var(--dark-text);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        /* ==================== å¿«æ·æ“ä½œé¢æ¿ ==================== */
        .quick-actions-panel {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
        }
        
        .quick-action-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: white;
            border: none;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
            color: var(--dark-text);
            transition: all 0.3s;
        }
        
        .quick-action-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .quick-action-btn.active {
            background: var(--accent-color);
            color: white;
        }
        
        /* ==================== éŸ¿æ‡‰å¼è¨­è¨ˆ ==================== */
        @media (max-width: 1024px) {
            .main-content {
                flex-direction: column;
            }
            
            .info-section {
                border-left: none;
                border-top: 1px solid var(--border-color);
            }
            
            .map-section {
                min-height: 500px;
            }
            
            #map {
                height: 500px;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                border-radius: 0;
                margin: 0;
            }
            
            body {
                padding: 0;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .map-controls {
                position: relative;
                top: 0;
                right: 0;
                margin-bottom: 20px;
                flex-direction: row;
                flex-wrap: wrap;
                background: transparent;
                box-shadow: none;
                padding: 0;
            }
            
            .map-type-selector, .coordinate-picker-toggle {
                flex: 1;
                min-width: 200px;
            }
            
            .tab-container {
                justify-content: flex-start;
            }
            
            .tab {
                padding: 10px 15px;
                font-size: 13px;
            }
            
            .controls {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 480px) {
            .map-controls {
                flex-direction: column;
            }
            
            .map-type-selector, .coordinate-picker-toggle {
                width: 100%;
            }
            
            .card-actions {
                flex-direction: column;
            }
            
            .action-btn {
                width: 100%;
            }
            
            .controls {
                grid-template-columns: 1fr;
            }
        }
        
        /* ==================== å‹•ç•«æ•ˆæœ ==================== */
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* ==================== è¡¨å–®æ¨£å¼ ==================== */
        .add-form {
            background: var(--card-bg);
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-text);
            font-size: 14px;
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 14px;
            transition: all var(--transition-speed);
            background: var(--card-bg);
        }
        
        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        .form-group textarea {
            min-height: 100px;
            resize: vertical;
            line-height: 1.5;
        }
        
        .coord-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .coord-picker-info {
            font-size: 13px;
            color: var(--light-text);
            margin-top: 8px;
            padding: 12px;
            background-color: #f8fafc;
            border-radius: 8px;
            border-left: 3px solid var(--accent-color);
        }
        
        /* ==================== åœ˜éšŠæˆå“¡æ¨£å¼ ==================== */
        .team-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        .team-member {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e9ecef;
            transition: all 0.3s ease;
        }
        
        .team-member:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 12px rgba(0, 0, 0, 0.1);
        }
        
        .member-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            margin: 0 auto 10px;
            background: linear-gradient(to right, #3498db, #2980b9);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .member-name {
            font-weight: bold;
            color: var(--dark-text);
            margin-bottom: 5px;
            font-size: 1rem;
        }
        
        .member-role {
            font-size: 0.85rem;
            color: #3498db;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .member-tasks {
            font-size: 0.8rem;
            color: #7f8c8d;
            line-height: 1.4;
        }
        
        /* ==================== æ•™å­¸é¢æ¿ ==================== */
        .tutorial-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            z-index: 10001;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            display: none;
        }
        
        .tutorial-header {
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .tutorial-title {
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .tutorial-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.8rem;
            cursor: pointer;
            padding: 0;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 10000;
            display: none;
        }
        
        /* ==================== å°å‡ºé¸é …é¢æ¿ ==================== */
        .export-options {
            display: none;
            position: absolute;
            bottom: 80px;
            right: 20px;
            background: white;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            z-index: 1001;
            min-width: 200px;
        }
        
        .export-options.show {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }
        
        .export-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .export-option:hover {
            background-color: #f8f9fa;
        }
        
        .export-icon {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #3498db;
        }
        
        /* ==================== è‡ªå®šç¾©åœ°åœ–æ¨™è¨˜ ==================== */
        .custom-marker {
            background-color: var(--accent-color);
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 12px;
            transition: all var(--transition-speed);
        }
        
        .custom-marker:hover {
            transform: scale(1.2);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
        }
        
        /* ==================== åº§æ¨™æ‹¾å–å™¨ ==================== */
        .picker-marker {
            background-color: var(--purple-color);
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 0 15px rgba(155, 89, 182, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 14px;
            z-index: 1001;
            animation: pulse 1.5s infinite;
        }
        
        .picker-mode-active #map {
            cursor: crosshair;
            box-shadow: 0 0 0 3px rgba(155, 89, 182, 0.3);
            border-color: var(--purple-color);
        }
        
        .coordinate-notification {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(155, 89, 182, 0.95);
            color: white;
            padding: 12px 24px;
            border-radius: 50px;
            z-index: 1000;
            font-size: 14px;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            display: none;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.8; }
            100% { opacity: 1; }
        }
        
        /* ==================== è³‡è¨Šå¡ç‰‡æ¨£å¼ ==================== */
        .info-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border-left: 5px solid #3498db;
            transition: all 0.3s ease;
        }
        
        .info-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .info-card-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            color: var(--dark-text);
            font-size: 1.1rem;
            font-weight: bold;
        }
        
        .info-card-title i {
            color: #3498db;
            font-size: 1.2rem;
        }
        
        .info-card-content {
            color: #555;
            font-size: 0.9rem;
            line-height: 1.6;
        }
        
        /* ==================== ç©ºç‹€æ…‹æ¨£å¼ ==================== */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--light-text);
        }
        
        .empty-state i {
            font-size: 48px;
            margin-bottom: 20px;
            color: #ddd;
        }
        
        .empty-state h3 {
            font-size: 18px;
            margin-bottom: 10px;
            color: var(--medium-text);
        }
        
        /* ==================== åŠ è¼‰ç‹€æ…‹ ==================== */
        .loading {
            position: relative;
            pointer-events: none;
        }
        
        .loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 24px;
            height: 24px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--accent-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }
        
        /* ==================== ä¸‹æ‹‰é¸å–®æ¨£å¼ ==================== */
        select {
            width: 100%;
            padding: 10px 15px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            background: var(--card-bg);
            color: var(--dark-text);
            cursor: pointer;
            transition: all var(--transition-speed);
        }
        
        select:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        /* ==================== åº§æ¨™æ‹¾å–å™¨é–‹é—œ ==================== */
        .coordinate-picker-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
        }
        
        .coordinate-picker-toggle input[type="checkbox"] {
            width: 40px;
            height: 20px;
            appearance: none;
            background: #ddd;
            border-radius: 10px;
            position: relative;
            cursor: pointer;
            transition: all var(--transition-speed);
        }
        
        .coordinate-picker-toggle input[type="checkbox"]:checked {
            background: var(--accent-color);
        }
        
        .coordinate-picker-toggle input[type="checkbox"]::before {
            content: '';
            position: absolute;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: white;
            top: 2px;
            left: 2px;
            transition: all var(--transition-speed);
        }
        
        .coordinate-picker-toggle input[type="checkbox"]:checked::before {
            left: 22px;
        }
    </style>
</head>
<body class="theme-light-active">
    <div class="container">
        <header>
            <h1 id="app-title">åœ˜çµå°éšŠ_é›»å­åœ°åœ–</h1>
            <p class="subtitle" id="app-subtitle">æ”¯æ´å¤šç¨®åœ°åœ–åˆ‡æ›ï¼Œå¯è‡ªè¨‚åœ°é»ã€åœ–ç‰‡å’Œæ–‡å­—æè¿°</p>
        </header>
        
        <div class="main-content">
            <div class="map-section">
                <div id="map"></div>
                
                <div class="coordinate-notification" id="coordinateNotification">
                    å·²é¸å–åº§æ¨™ï¼Œå·²å¡«å…¥è¡¨å–®
                </div>
                
                <!-- è·¯å¾‘é è¦½é¢æ¿ -->
                <div class="path-preview-panel" id="pathPreviewPanel">
                    <div class="path-preview-title">
                        <span>è·¯å¾‘é è¦½</span>
                        <button class="map-info-close" onclick="togglePathPreviewPanel()">Ã—</button>
                    </div>
                    <div class="path-preview-stats" id="pathPreviewStats">
                        <!-- å°‡ç”±JavaScriptå‹•æ…‹ç”Ÿæˆ -->
                    </div>
                    <div class="batch-actions" id="pathBatchActions">
                        <button class="btn-batch btn-batch-add" onclick="addAllLocationsToPath()" id="btn-batch-add">åŠ å…¥å…¨éƒ¨åœ°é»</button>
                        <button class="btn-batch btn-batch-reverse" onclick="reversePath()" id="btn-batch-reverse">åè½‰è·¯å¾‘</button>
                        <button class="btn-batch btn-batch-clear" onclick="clearDrawing()" id="btn-batch-clear">æ¸…é™¤è·¯å¾‘</button>
                    </div>
                </div>
                
                <!-- å¿«æ·æ“ä½œé¢æ¿ -->
                <div class="quick-actions-panel">
                    <button class="quick-action-btn" onclick="togglePathPreviewPanel()" id="quick-path-preview" title="è·¯å¾‘é è¦½">
                        <i class="fas fa-route"></i>
                    </button>
                    <button class="quick-action-btn" onclick="toggleExportOptions()" id="quick-export" title="å°å‡ºé¸é …">
                        <i class="fas fa-download"></i>
                    </button>
                    <button class="quick-action-btn" onclick="toggleDrawingMode()" id="quick-drawing" title="ç¹ªè£½æ¨¡å¼">
                        <i class="fas fa-pencil-alt"></i>
                    </button>
                </div>
                
                <!-- å°å‡ºé¸é …é¢æ¿ -->
                <div class="export-options" id="exportOptions">
                    <div class="export-option" onclick="exportPathData('gpx')">
                        <div class="export-icon">
                            <i class="fas fa-file-code"></i>
                        </div>
                        <div class="export-info">
                            <div class="export-name" id="export-gpx-name">GPX æ ¼å¼</div>
                            <div class="export-desc" id="export-gpx-desc">é€šç”¨GPSäº¤æ›æ ¼å¼</div>
                        </div>
                    </div>
                    <div class="export-option" onclick="exportPathData('kml')">
                        <div class="export-icon">
                            <i class="fas fa-globe-americas"></i>
                        </div>
                        <div class="export-info">
                            <div class="export-name" id="export-kml-name">KML æ ¼å¼</div>
                            <div class="export-desc" id="export-kml-desc">Google Earthæ ¼å¼</div>
                        </div>
                    </div>
                    <div class="export-option" onclick="exportPathData('geojson')">
                        <div class="export-icon">
                            <i class="fas fa-code"></i>
                        </div>
                        <div class="export-info">
                            <div class="export-name" id="export-geojson-name">GeoJSON æ ¼å¼</div>
                            <div class="export-desc" id="export-geojson-desc">Webåœ°åœ–å¸¸ç”¨æ ¼å¼</div>
                        </div>
                    </div>
                </div>
                
                <div class="map-controls">
                    <div class="map-type-selector">
                        <select id="mapType" onchange="changeMapType(this.value)">
                            <option value="osm">OpenStreetMap æ¨™æº–</option>
                            <option value="osmHot">OpenStreetMap H.O.T.</option>
                            <option value="osmCycle">OpenStreetMap å–®è»Šåœ°åœ–</option>
                            <option value="osmTransport">OpenStreetMap äº¤é€šåœ°åœ–</option>
                            <option value="cartoVoyager">CartoDB Voyager</option>
                            <option value="cartoDark">CartoDB æ·±è‰²</option>
                            <option value="esriWorld">ESRI ä¸–ç•Œåœ°åœ–</option>
                            <option value="stadia">Stadia åœ°åœ–</option>
                            <option value="opentopomap">OpenTopoMap</option>
                            <option value="wikimedia">Wikimedia åœ°åœ–</option>
                        </select>
                    </div>
                    
                    <div class="coordinate-picker-toggle">
                        <label for="coordinatePickerToggle" id="picker-label">åº§æ¨™æ‹¾å–å™¨</label>
                        <input type="checkbox" id="coordinatePickerToggle" onchange="toggleCoordinatePicker()">
                    </div>
                </div>
            </div>
            
            <div class="info-section">
                <div class="tab-container">
                    <button class="tab active" onclick="switchTab('locations')" id="tab-locations">åœ°é»æ¸…å–®</button>
                    <button class="tab" onclick="switchTab('add')" id="tab-add">æ–°å¢åœ°é»</button>
                    <button class="tab" onclick="switchTab('maps')" id="tab-maps">åœ°åœ–é¸æ“‡</button>
                    <button class="tab" onclick="switchTab('team')" id="tab-team">åˆ†å·¥åå–®</button>
                    <button class="tab" onclick="switchTab('info')" id="tab-info">ç³»çµ±è³‡è¨Š</button>
                </div>
                
                <div class="tab-content">
                    <!-- åœ°é»æ¸…å–®é ç±¤ -->
                    <div id="locations-tab" class="tab-pane active">
                        <div class="search-box">
                            <input type="text" id="locationSearch" placeholder="æœå°‹åœ°é»..." onkeyup="searchLocations()">
                        </div>
                        <div class="location-list" id="locationList">
                            <!-- åœ°é»å¡ç‰‡å°‡å‹•æ…‹ç”Ÿæˆ -->
                        </div>
                    </div>
                    
                    <!-- æ–°å¢åœ°é»é ç±¤ -->
                    <div id="add-tab" class="tab-pane">
                        <h3 class="mb-20" id="add-title">æ–°å¢åœ°é»</h3>
                        
                        <div class="add-form">
                            <form id="locationForm">
                                <div class="form-group">
                                    <label for="name" id="label-name">åœ°é»åç¨± *</label>
                                    <input type="text" id="name" required placeholder="ä¾‹å¦‚: æ¾³é–€æ—…éŠå¡”">
                                </div>
                                
                                <div class="coord-inputs">
                                    <div class="form-group">
                                        <label for="lat" id="label-lat">ç·¯åº¦ (Latitude) *</label>
                                        <input type="number" step="any" id="lat" required placeholder="ä¾‹å¦‚: 22.1987">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="lng" id="label-lng">ç¶“åº¦ (Longitude) *</label>
                                        <input type="number" step="any" id="lng" required placeholder="ä¾‹å¦‚: 113.5439">
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <div class="coord-picker-info" id="coordPickerInfo">
                                        é»æ“Šä¸Šæ–¹ã€Œåº§æ¨™æ‹¾å–å™¨ã€é–‹é—œï¼Œç„¶å¾Œé»æ“Šåœ°åœ–ä¸Šçš„ä½ç½®ä¾†ç²å–åº§æ¨™
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="date" id="label-date">é€ è¨ªæ—¥æœŸ</label>
                                    <input type="date" id="date" value="">
                                </div>
                                
                                <div class="form-group">
                                    <label for="image" id="label-image">åœ–ç‰‡ç¶²å€</label>
                                    <input type="text" id="image" placeholder="è«‹è¼¸å…¥åœ–ç‰‡ç¶²å€">
                                    <p class="mt-10" id="image-hint">
                                        å¯ä½¿ç”¨ Unsplash åœ–ç‰‡: https://images.unsplash.com/photo-...
                                    </p>
                                </div>
                                
                                <div class="form-group">
                                    <label for="description" id="label-description">åœ°é»æè¿°</label>
                                    <textarea id="description" placeholder="è«‹æè¿°é€™å€‹åœ°é»..."></textarea>
                                </div>
                                
                                <div class="form-group">
                                    <label for="color" id="label-color">æ¨™è¨˜é¡è‰²</label>
                                    <input type="color" id="color" value="#3498db" class="color-picker">
                                </div>
                                
                                <div class="form-actions">
                                    <button type="button" class="btn" id="btn-submit" onclick="addLocation()">æ–°å¢åœ°é»</button>
                                    <button type="button" class="btn btn-cancel" onclick="clearForm()" id="btn-clear">æ¸…é™¤è¡¨å–®</button>
                                    <button type="button" class="btn btn-picker" onclick="useCoordinatePicker()" id="btn-picker">ä½¿ç”¨åº§æ¨™æ‹¾å–å™¨</button>
                                </div>
                            </form>
                            
                            <!-- è·¯å¾‘ç¹ªè£½åŠŸèƒ½ -->
                            <div class="mt-20 pt-15" style="border-top: 1px solid #eee;">
                                <h4 class="mb-10" id="drawing-title">
                                    è·¯å¾‘ç¹ªè£½å·¥å…·
                                    <button class="guide-help-btn" onclick="showTutorial()" title="é¡¯ç¤ºæ•™å­¸">?</button>
                                </h4>
                                <p class="mb-10" id="drawing-desc">
                                    é»æ“Šã€Œé–‹å§‹ç¹ªè£½ã€æŒ‰éˆ•ï¼Œç„¶å¾Œåœ¨åœ°åœ–ä¸Šé»æ“Šæˆ–å¾åœ°é»æ¸…å–®ä¸­æ·»åŠ é»ä¾†ç¹ªè£½è‡ªå®šç¾©è·¯å¾‘
                                </p>
                                
                                <div class="drawing-controls" id="drawingControls">
                                    <button class="btn" id="btn-start-drawing" onclick="startDrawing()">é–‹å§‹ç¹ªè£½</button>
                                    <button class="btn" id="btn-finish-drawing" onclick="finishDrawing()">å®Œæˆç¹ªè£½</button>
                                    <button class="btn" id="btn-convert-points" onclick="convertDrawingPointsToLocations()">è½‰æ›ç‚ºåœ°é»</button>
                                    <button class="btn btn-cancel" id="btn-clear-drawing" onclick="clearDrawing()">æ¸…é™¤</button>
                                </div>
                                
                                <!-- ç¹ªè£½é»åˆ—è¡¨ -->
                                <div class="drawing-point-list" id="drawingPointList">
                                    <!-- ç¹ªè£½é»å°‡å‹•æ…‹ç”Ÿæˆ -->
                                </div>
                                
                                <!-- å°å‡ºæŒ‰éˆ• -->
                                <div class="export-buttons mt-15">
                                    <button class="btn btn-export" onclick="exportPathData('gpx')" id="btn-export-gpx">å°å‡ºGPX</button>
                                    <button class="btn btn-export" onclick="exportPathData('kml')" id="btn-export-kml">å°å‡ºKML</button>
                                    <button class="btn btn-export" onclick="exportPathData('geojson')" id="btn-export-geojson">å°å‡ºGeoJSON</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- åœ°åœ–é¸æ“‡é ç±¤ -->
                    <div id="maps-tab" class="tab-pane">
                        <h3 class="mb-15" id="maps-title">é¸æ“‡åœ°åœ–é¡å‹</h3>
                        <p class="mb-15" id="maps-desc">
                            é»æ“Šä¸‹æ–¹çš„åœ°åœ–æä¾›è€…åˆ‡æ›ä¸åŒé¢¨æ ¼çš„åœ°åœ–
                        </p>
                        
                        <div class="map-providers">
                            <div class="provider-card active" onclick="selectMapProvider('osm')">
                                <div class="provider-name">OpenStreetMap</div>
                                <div class="provider-desc">æ¨™æº–è¡—é“åœ°åœ–</div>
                            </div>
                            
                            <div class="provider-card" onclick="selectMapProvider('osmHot')">
                                <div class="provider-name">OSM H.O.T.</div>
                                <div class="provider-desc">äººé“ä¸»ç¾©åœ°åœ–</div>
                            </div>
                            
                            <div class="provider-card" onclick="selectMapProvider('osmCycle')">
                                <div class="provider-name">å–®è»Šåœ°åœ–</div>
                                <div class="provider-desc">é©åˆå–®è»Šè·¯ç·š</div>
                            </div>
                            
                            <div class="provider-card" onclick="selectMapProvider('osmTransport')">
                                <div class="provider-name">äº¤é€šåœ°åœ–</div>
                                <div class="provider-desc">å…¬å…±äº¤é€šè·¯ç·š</div>
                            </div>
                            
                            <div class="provider-card" onclick="selectMapProvider('cartoVoyager')">
                                <div class="provider-name">CartoDB Voyager</div>
                                <div class="provider-desc">ç¾ä»£åŒ–åœ°åœ–</div>
                            </div>
                            
                            <div class="provider-card" onclick="selectMapProvider('cartoDark')">
                                <div class="provider-name">æ·±è‰²åœ°åœ–</div>
                                <div class="provider-desc">å¤œé–“/ä½å…‰æºä½¿ç”¨</div>
                            </div>
                            
                            <div class="provider-card" onclick="selectMapProvider('esriWorld')">
                                <div class="provider-name">ESRI åœ°åœ–</div>
                                <div class="provider-desc">é«˜è§£æåº¦åœ°åœ–</div>
                            </div>
                            
                            <div class="provider-card" onclick="selectMapProvider('stadia')">
                                <div class="provider-name">Stadia åœ°åœ–</div>
                                <div class="provider-desc">ç¾ä»£åœ°åœ–é¢¨æ ¼</div>
                            </div>
                            
                            <div class="provider-card" onclick="selectMapProvider('opentopomap')">
                                <div class="provider-name">OpenTopoMap</div>
                                <div class="provider-desc">åœ°å½¢åœ°åœ–</div>
                            </div>
                            
                            <div class="provider-card" onclick="selectMapProvider('wikimedia')">
                                <div class="provider-name">Wikimedia åœ°åœ–</div>
                                <div class="provider-desc">ç¶­åŸºåª’é«”åœ°åœ–</div>
                            </div>
                        </div>
                        
                        <div class="info-card mt-20">
                            <h4 class="info-card-title" id="maps-tips-title">åœ°åœ–æç¤º</h4>
                            <div class="info-card-content">
                                <p id="maps-tip1">â€¢ OpenStreetMap æ˜¯å…è²»é–‹æºåœ°åœ–ï¼Œç„¡éœ€APIé‡‘é‘°</p>
                                <p id="maps-tip2">â€¢ æ‰€æœ‰åœ°åœ–é¡å‹å‡å…è²»ä½¿ç”¨</p>
                                <p id="maps-tip3">â€¢ æŸäº›åœ°åœ–å¯èƒ½è¼‰å…¥è¼ƒæ…¢ï¼Œè«‹è€å¿ƒç­‰å¾…</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- åˆ†å·¥åå–®é ç±¤ -->
                    <div id="team-tab" class="tab-pane">
                        <div class="team-container">
                            <div class="team-section">
                                <h4 class="team-title" id="team-title">åœ˜éšŠæˆå“¡èˆ‡åˆ†å·¥</h4>
                                
                                <div class="team-grid" id="team-grid">
                                    <!-- åœ˜éšŠæˆå“¡å°‡ç”±JavaScriptå‹•æ…‹ç”Ÿæˆ -->
                                </div>
                                
                                <div class="team-stats">
                                    <div class="team-stat">
                                        <div class="team-stat-value" id="total-members">5</div>
                                        <div class="team-stat-label">åœ˜éšŠæˆå“¡</div>
                                    </div>
                                    <div class="team-stat">
                                        <div class="team-stat-value" id="total-tasks">12</div>
                                        <div class="team-stat-label">ç¸½ä»»å‹™æ•¸</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="team-section">
                                <h4 class="team-title" id="timeline-title">å°ˆæ¡ˆæ™‚é–“è»¸</h4>
                                
                                <div class="timeline">
                                    <div class="timeline-item">
                                        <div class="timeline-date">2025å¹´12æœˆ</div>
                                        <div class="timeline-content" id="timeline-1">å°ˆæ¡ˆå•Ÿå‹•èˆ‡éœ€æ±‚åˆ†æ</div>
                                    </div>
                                    <div class="timeline-item">
                                        <div class="timeline-date">2025å¹´12æœˆ</div>
                                        <div class="timeline-content" id="timeline-2">åœ°åœ–åŠŸèƒ½é–‹ç™¼èˆ‡æ¸¬è©¦</div>
                                    </div>
                                    <div class="timeline-item">
                                        <div class="timeline-date">2026å¹´1æœˆ</div>
                                        <div class="timeline-content" id="timeline-3">å¤šèªè¨€æ”¯æ´èˆ‡å„ªåŒ–</div>
                                    </div>
                                    <div class="timeline-item">
                                        <div class="timeline-date">2026å¹´1æœˆ</div>
                                        <div class="timeline-content" id="timeline-4">æœ€çµ‚æ¸¬è©¦èˆ‡éƒ¨ç½²</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="team-section">
                                <h4 class="team-title" id="project-title">å°ˆæ¡ˆè³‡è¨Š</h4>
                                
                                <div class="info-card-content">
                                    <p id="project-desc">
                                        æœ¬å°ˆæ¡ˆç‚ºã€Œåœ˜çµå°éšŠã€é›»å­åœ°åœ–ç³»çµ±ï¼Œæ—¨åœ¨æä¾›ä¸€å€‹å¤šåŠŸèƒ½ã€å¯è‡ªè¨‚çš„åœ°åœ–æ‡‰ç”¨ç¨‹å¼ï¼Œæ”¯æ´å¤šç¨®åœ°åœ–é¡å‹ã€åœ°é»æ¨™è¨˜ã€è·¯ç·šè¦åŠƒç­‰åŠŸèƒ½ã€‚
                                    </p>
                                    <p id="project-feature1">â€¢ æ”¯æ´10ç¨®ä»¥ä¸Šåœ°åœ–é¡å‹</p>
                                    <p id="project-feature2">â€¢ å®Œæ•´çš„å¤šèªè¨€æ”¯æ´</p>
                                    <p id="project-feature3">â€¢ å¯è‡ªè¨‚æ¨™è¨˜èˆ‡è·¯ç·š</p>
                                    <p id="project-feature4">â€¢ é›¢ç·šè³‡æ–™å„²å­˜åŠŸèƒ½</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ç³»çµ±è³‡è¨Šé ç±¤ -->
                    <div id="info-tab" class="tab-pane">
                        <div class="settings-container">
                            <div class="info-card">
                                <div class="info-card-title">
                                    <i class="fas fa-info-circle"></i>
                                    <span id="info-title">ç³»çµ±è³‡è¨Š</span>
                                </div>
                                <div class="info-card-content">
                                    <p id="info-description">æœ¬é›»å­åœ°åœ–ç³»çµ±æä¾›å¤šç¨®åœ°åœ–é¡å‹ã€åœ°é»æ¨™è¨˜ã€è·¯ç·šè¦åŠƒç­‰åŠŸèƒ½ï¼Œæ”¯æ´é›¢ç·šä½¿ç”¨å’Œè³‡æ–™æœ¬åœ°å„²å­˜ã€‚</p>
                                    
                                    <div class="info-stats">
                                        <div class="info-stat">
                                            <div class="info-stat-icon"><i class="fas fa-map-marked-alt"></i></div>
                                            <div class="info-stat-value" id="stat-locations">0</div>
                                            <div class="info-stat-label" id="label-stat-locations">åœ°é»æ¨™è¨˜</div>
                                        </div>
                                        <div class="info-stat">
                                            <div class="info-stat-icon"><i class="fas fa-layer-group"></i></div>
                                            <div class="info-stat-value">12</div>
                                            <div class="info-stat-label" id="label-stat-layers">åœ°åœ–åœ–å±¤</div>
                                        </div>
                                        <div class="info-stat">
                                            <div class="info-stat-icon"><i class="fas fa-language"></i></div>
                                            <div class="info-stat-value">3</div>
                                            <div class="info-stat-label" id="label-stat-languages">æ”¯æ´èªè¨€</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="info-card">
                                <div class="info-card-title">
                                    <i class="fas fa-sliders-h"></i>
                                    <span id="system-settings-title">ç³»çµ±è¨­å®š</span>
                                </div>
                                <div class="info-card-content">
                                    <div class="setting-group">
                                        <label class="setting-label" id="label-language">èªè¨€è¨­å®š</label>
                                        <select id="appLanguage" class="setting-control" onchange="changeLanguage(this.value)">
                                            <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
                                            <option value="en">English</option>
                                            <option value="pt">PortuguÃªs</option>
                                        </select>
                                        <div class="setting-description" id="desc-language">é¸æ“‡æ‡‰ç”¨ç¨‹å¼çš„é¡¯ç¤ºèªè¨€</div>
                                    </div>
                                    
                                    <ul class="info-feature-list">
                                        <li class="info-feature-item">
                                            <div class="info-feature-icon"><i class="fas fa-check"></i></div>
                                            <span id="feature1">æ”¯æ´10ç¨®ä»¥ä¸Šåœ°åœ–é¡å‹</span>
                                        </li>
                                        <li class="info-feature-item">
                                            <div class="info-feature-icon"><i class="fas fa-check"></i></div>
                                            <span id="feature2">å®Œæ•´çš„å¤šèªè¨€æ”¯æ´</span>
                                        </li>
                                        <li class="info-feature-item">
                                            <div class="info-feature-icon"><i class="fas fa-check"></i></div>
                                            <span id="feature3">å¯è‡ªè¨‚æ¨™è¨˜èˆ‡è·¯ç·š</span>
                                        </li>
                                        <li class="info-feature-item">
                                            <div class="info-feature-icon"><i class="fas fa-check"></i></div>
                                            <span id="feature4">é›¢ç·šè³‡æ–™å„²å­˜åŠŸèƒ½</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            
                            <div class="settings-actions">
                                <button class="btn" onclick="applyAllSettings()" id="btn-apply">å¥—ç”¨æ‰€æœ‰è¨­å®š</button>
                                <button class="btn btn-reset" onclick="resetAllSettings()" id="btn-reset">é‡ç½®ç‚ºé è¨­å€¼</button>
                                <button class="btn" onclick="saveSettings()" id="btn-save">å„²å­˜è¨­å®š</button>
                            </div>
                            
                            <div style="text-align: center; margin-top: 15px; padding-top: 15px; border-top: 1px solid #eee;">
                                <p style="font-size: 0.8rem; color: #7f8c8d;">
                                    ç‰ˆæœ¬: 2.0.0 | æœ€å¾Œæ›´æ–°: 2026å¹´1æœˆ | é–‹ç™¼è€…: åœ˜çµå°éšŠ
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="controls">
            <button class="btn btn-reset" onclick="resetMap()" id="btn-reset-view">é‡ç½®è¦–è§’</button>
            <button class="btn btn-path" onclick="togglePath()" id="btn-path">è·¯ç·šé–‹é—œ</button>
            <button class="btn" onclick="showAllMarkers()" id="btn-show-all">é¡¯ç¤ºå…¨éƒ¨</button>
            <button class="btn" onclick="getCurrentLocation()" id="btn-my-location">æˆ‘çš„ä½ç½®</button>
            <button class="btn" onclick="toggleDrawingMode()" id="btn-drawing">ç¹ªè£½æ¨¡å¼</button>
            <button class="btn btn-arrow" onclick="createArrowPathFromLocations()" id="btn-arrow-path">ç®­é ­è·¯å¾‘</button>
        </div>
        
        <footer>
            <p id="footer-text">é›»å­åœ°åœ– â€¢ åœ˜çµå°éšŠï½é–‹ç™¼è€…â€”Haruki.Nâ€¢ å¯é›¢ç·šä½¿ç”¨ â€¢ æœ€å¾Œæ›´æ–°: 2026å¹´1æœˆ</p>
        </footer>
    </div>
    
    <!-- æ•™å­¸é¢æ¿ -->
    <div class="overlay" id="tutorialOverlay" onclick="closeTutorial()"></div>
    <div class="tutorial-panel" id="tutorialPanel">
        <div class="tutorial-header">
            <div class="tutorial-title" id="tutorial-title">é›»å­åœ°åœ–ä½¿ç”¨æ•™å­¸</div>
            <button class="tutorial-close" onclick="closeTutorial()">Ã—</button>
        </div>
        <div class="tutorial-content" id="tutorial-content">
            <!-- å…§å®¹å°‡ç”±JavaScriptå‹•æ…‹ç”Ÿæˆ -->
        </div>
    </div>

    <script>
        // ==================== èªè¨€æ”¯æ´ ====================
        const translations = {
            'zh-TW': {
                // æ‡‰ç”¨ç¨‹å¼æ¨™é¡Œ
                'app-title': 'åœ˜çµå°éšŠ_é›»å­åœ°åœ–',
                'app-subtitle': 'æ”¯æ´å¤šç¨®åœ°åœ–åˆ‡æ›ï¼Œå¯è‡ªè¨‚åœ°é»ã€åœ–ç‰‡å’Œæ–‡å­—æè¿°',
                
                // é ç±¤æ¨™é¡Œ
                'tab-locations': 'åœ°é»æ¸…å–®',
                'tab-add': 'æ–°å¢åœ°é»',
                'tab-maps': 'åœ°åœ–é¸æ“‡',
                'tab-team': 'åˆ†å·¥åå–®',
                'tab-info': 'ç³»çµ±è³‡è¨Š',
                
                // åº§æ¨™æ‹¾å–å™¨
                'picker-label': 'åº§æ¨™æ‹¾å–å™¨',
                'picker-info': 'é»æ“Šä¸Šæ–¹ã€Œåº§æ¨™æ‹¾å–å™¨ã€é–‹é—œï¼Œç„¶å¾Œé»æ“Šåœ°åœ–ä¸Šçš„ä½ç½®ä¾†ç²å–åº§æ¨™',
                'picker-active': 'åº§æ¨™æ‹¾å–å™¨å·²å•Ÿç”¨ï¼è«‹é»æ“Šåœ°åœ–ä¸Šçš„ä½ç½®ä¾†ç²å–åº§æ¨™',
                'picker-notification': 'å·²é¸å–åº§æ¨™ï¼Œå·²å¡«å…¥è¡¨å–®',
                
                // æ§åˆ¶æŒ‰éˆ•
                'btn-reset-view': 'é‡ç½®è¦–è§’',
                'btn-path': 'è·¯ç·šé–‹é—œ',
                'btn-show-all': 'é¡¯ç¤ºå…¨éƒ¨',
                'btn-my-location': 'æˆ‘çš„ä½ç½®',
                'btn-drawing': 'ç¹ªè£½æ¨¡å¼',
                'btn-arrow-path': 'ç®­é ­è·¯å¾‘',
                'btn-start-drawing': 'é–‹å§‹ç¹ªè£½',
                'btn-finish-drawing': 'å®Œæˆç¹ªè£½',
                'btn-convert-points': 'è½‰æ›ç‚ºåœ°é»',
                'btn-clear-drawing': 'æ¸…é™¤',
                
                // æ–°å¢åœ°é»è¡¨å–®
                'add-title': 'æ–°å¢åœ°é»',
                'label-name': 'åœ°é»åç¨± *',
                'label-lat': 'ç·¯åº¦ (Latitude) *',
                'label-lng': 'ç¶“åº¦ (Longitude) *',
                'label-date': 'é€ è¨ªæ—¥æœŸ',
                'label-image': 'åœ–ç‰‡ç¶²å€',
                'label-description': 'åœ°é»æè¿°',
                'label-color': 'æ¨™è¨˜é¡è‰²',
                'image-hint': 'å¯ä½¿ç”¨ Unsplash åœ–ç‰‡: https://images.unsplash.com/photo-...',
                'btn-submit': 'æ–°å¢åœ°é»',
                'btn-clear': 'æ¸…é™¤è¡¨å–®',
                'btn-picker': 'ä½¿ç”¨åº§æ¨™æ‹¾å–å™¨',
                
                // åœ°åœ–é¸æ“‡
                'maps-title': 'é¸æ“‡åœ°åœ–é¡å‹',
                'maps-desc': 'é»æ“Šä¸‹æ–¹çš„åœ°åœ–æä¾›è€…åˆ‡æ›ä¸åŒé¢¨æ ¼çš„åœ°åœ–',
                'maps-tips-title': 'åœ°åœ–æç¤º',
                'maps-tip1': 'â€¢ OpenStreetMap æ˜¯å…è²»é–‹æºåœ°åœ–ï¼Œç„¡éœ€APIé‡‘é‘°',
                'maps-tip2': 'â€¢ æ‰€æœ‰åœ°åœ–é¡å‹å‡å…è²»ä½¿ç”¨',
                'maps-tip3': 'â€¢ æŸäº›åœ°åœ–å¯èƒ½è¼‰å…¥è¼ƒæ…¢ï¼Œè«‹è€å¿ƒç­‰å¾…',
                
                // è·¯å¾‘ç¹ªè£½
                'drawing-title': 'è·¯å¾‘ç¹ªè£½å·¥å…·',
                'drawing-desc': 'é»æ“Šã€Œé–‹å§‹ç¹ªè£½ã€æŒ‰éˆ•ï¼Œç„¶å¾Œåœ¨åœ°åœ–ä¸Šé»æ“Šæˆ–å¾åœ°é»æ¸…å–®ä¸­æ·»åŠ é»ä¾†ç¹ªè£½è‡ªå®šç¾©è·¯å¾‘',
                
                // åˆ†å·¥åå–®
                'team-title': 'åœ˜éšŠæˆå“¡èˆ‡åˆ†å·¥',
                'timeline-title': 'å°ˆæ¡ˆæ™‚é–“è»¸',
                'project-title': 'å°ˆæ¡ˆè³‡è¨Š',
                'project-desc': 'æœ¬å°ˆæ¡ˆç‚ºã€Œåœ˜çµå°éšŠã€é›»å­åœ°åœ–ç³»çµ±ï¼Œæ—¨åœ¨æä¾›ä¸€å€‹å¤šåŠŸèƒ½ã€å¯è‡ªè¨‚çš„åœ°åœ–æ‡‰ç”¨ç¨‹å¼ï¼Œæ”¯æ´å¤šç¨®åœ°åœ–é¡å‹ã€åœ°é»æ¨™è¨˜ã€è·¯ç·šè¦åŠƒç­‰åŠŸèƒ½ã€‚',
                'project-feature1': 'â€¢ æ”¯æ´10ç¨®ä»¥ä¸Šåœ°åœ–é¡å‹',
                'project-feature2': 'â€¢ å®Œæ•´çš„å¤šèªè¨€æ”¯æ´',
                'project-feature3': 'â€¢ å¯è‡ªè¨‚æ¨™è¨˜èˆ‡è·¯ç·š',
                'project-feature4': 'â€¢ é›¢ç·šè³‡æ–™å„²å­˜åŠŸèƒ½',
                'timeline-1': 'å°ˆæ¡ˆå•Ÿå‹•èˆ‡éœ€æ±‚åˆ†æ',
                'timeline-2': 'åœ°åœ–åŠŸèƒ½é–‹ç™¼èˆ‡æ¸¬è©¦',
                'timeline-3': 'å¤šèªè¨€æ”¯æ´èˆ‡å„ªåŒ–',
                'timeline-4': 'æœ€çµ‚æ¸¬è©¦èˆ‡éƒ¨ç½²',
                
                // ç³»çµ±è³‡è¨Š
                'info-title': 'ç³»çµ±è³‡è¨Š',
                'info-description': 'æœ¬é›»å­åœ°åœ–ç³»çµ±æä¾›å¤šç¨®åœ°åœ–é¡å‹ã€åœ°é»æ¨™è¨˜ã€è·¯ç·šè¦åŠƒç­‰åŠŸèƒ½ï¼Œæ”¯æ´é›¢ç·šä½¿ç”¨å’Œè³‡æ–™æœ¬åœ°å„²å­˜ã€‚',
                'label-stat-locations': 'åœ°é»æ¨™è¨˜',
                'label-stat-layers': 'åœ°åœ–åœ–å±¤',
                'label-stat-languages': 'æ”¯æ´èªè¨€',
                'system-settings-title': 'ç³»çµ±è¨­å®š',
                'label-language': 'èªè¨€è¨­å®š',
                'desc-language': 'é¸æ“‡æ‡‰ç”¨ç¨‹å¼çš„é¡¯ç¤ºèªè¨€',
                'feature1': 'æ”¯æ´10ç¨®ä»¥ä¸Šåœ°åœ–é¡å‹',
                'feature2': 'å®Œæ•´çš„å¤šèªè¨€æ”¯æ´',
                'feature3': 'å¯è‡ªè¨‚æ¨™è¨˜èˆ‡è·¯ç·š',
                'feature4': 'é›¢ç·šè³‡æ–™å„²å­˜åŠŸèƒ½',
                'btn-apply': 'å¥—ç”¨æ‰€æœ‰è¨­å®š',
                'btn-reset': 'é‡ç½®ç‚ºé è¨­å€¼',
                'btn-save': 'å„²å­˜è¨­å®š',
                
                // å°å‡ºé¸é …
                'export-gpx-name': 'GPX æ ¼å¼',
                'export-gpx-desc': 'é€šç”¨GPSäº¤æ›æ ¼å¼',
                'export-kml-name': 'KML æ ¼å¼',
                'export-kml-desc': 'Google Earthæ ¼å¼',
                'export-geojson-name': 'GeoJSON æ ¼å¼',
                'export-geojson-desc': 'Webåœ°åœ–å¸¸ç”¨æ ¼å¼',
                'btn-export-gpx': 'å°å‡ºGPX',
                'btn-export-kml': 'å°å‡ºKML',
                'btn-export-geojson': 'å°å‡ºGeoJSON',
                
                // å…¶ä»–
                'footer-text': 'é›»å­åœ°åœ– â€¢ åœ˜çµå°éšŠï½é–‹ç™¼è€…â€”Haruki.Nâ€¢ å¯é›¢ç·šä½¿ç”¨ â€¢ æœ€å¾Œæ›´æ–°: 2026å¹´1æœˆ',
                'search-placeholder': 'æœå°‹åœ°é»...',
                'no-locations': 'å°šæœªæ–°å¢ä»»ä½•åœ°é»',
                'location-added': 'åœ°é»å·²æˆåŠŸæ–°å¢ï¼',
                'location-updated': 'åœ°é»å·²æˆåŠŸæ›´æ–°ï¼',
                'location-deleted': 'åœ°é»å·²åˆªé™¤ï¼',
                'confirm-delete': 'ç¢ºå®šè¦åˆªé™¤é€™å€‹åœ°é»å—ï¼Ÿ',
                'path-hidden': 'è·¯ç·šå·²éš±è—',
                'path-shown': 'è·¯ç·šå·²é¡¯ç¤º',
                'path-need-more': 'è«‹å…ˆæ–°å¢è‡³å°‘å…©å€‹åœ°é»ä»¥é¡¯ç¤ºè·¯ç·š',
                'location-found': 'å·²å®šä½åˆ°æ‚¨çš„ä½ç½®ï¼åº§æ¨™å·²è‡ªå‹•å¡«å…¥è¡¨å–®ã€‚',
                'location-error': 'ç„¡æ³•å–å¾—æ‚¨çš„ä½ç½®ï¼š',
                'location-unsupported': 'æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´åœ°ç†ä½ç½®åŠŸèƒ½ã€‚',
                'picker-enabled': 'åº§æ¨™æ‹¾å–å™¨å·²å•Ÿç”¨ï¼è«‹é»æ“Šåœ°åœ–ä¸Šçš„ä½ç½®ä¾†ç²å–åº§æ¨™ã€‚',
                'edit-instruction': 'è«‹ä¿®æ”¹åœ°é»è³‡è¨Šï¼Œç„¶å¾Œé»æ“Šã€Œæ›´æ–°åœ°é»ã€æŒ‰éˆ•ã€‚',
                'drawing-started': 'ç¹ªè£½æ¨¡å¼å·²å•Ÿç”¨ï¼è«‹é»æ“Šåœ°åœ–ä¸Šçš„ä½ç½®ä¾†æ·»åŠ è·¯å¾‘é»ã€‚',
                'drawing-finished': 'è·¯å¾‘ç¹ªè£½å®Œæˆï¼',
                'drawing-cleared': 'ç¹ªè£½è·¯å¾‘å·²æ¸…é™¤ã€‚',
                'drawing-need-more': 'è«‹è‡³å°‘æ·»åŠ å…©å€‹é»ä¾†ç¹ªè£½è·¯å¾‘ã€‚',
                'arrow-path-created': 'å·²ç‚ºç¾æœ‰è·¯å¾‘æ·»åŠ ç®­é ­æ¨™è¨˜ï¼',
                'export-success': 'è·¯å¾‘å·²æˆåŠŸå°å‡ºï¼',
                'offline-mode': 'æ‚¨ç›®å‰è™•æ–¼é›¢ç·šæ¨¡å¼ï¼Œè³‡æ–™å°‡åœ¨æœ¬æ©Ÿå„²å­˜ã€‚',
                'settings-applied': 'æ‰€æœ‰è¨­å®šå·²å¥—ç”¨ï¼',
                'confirm-reset': 'ç¢ºå®šè¦é‡ç½®æ‰€æœ‰è¨­å®šç‚ºé è¨­å€¼å—ï¼Ÿ',
                'settings-reset': 'æ‰€æœ‰è¨­å®šå·²é‡ç½®ç‚ºé è¨­å€¼ï¼',
                'points-converted': 'ç¹ªè£½é»å·²æˆåŠŸè½‰æ›ç‚ºåœ°é»ï¼',
                'convert-confirm': 'æ˜¯å¦å°‡ç¹ªè£½é»è½‰æ›ç‚ºåœ°é»ä¸¦æ·»åŠ åˆ°åœ°é»æ¸…å–®ï¼Ÿ',
                'convert-success': 'å·²æˆåŠŸæ·»åŠ  {count} å€‹ç¹ªè£½é»åˆ°åœ°é»æ¸…å–®ï¼',
                'all-locations-added': 'æ‰€æœ‰åœ°é»å·²åŠ å…¥ç¹ªè£½è·¯å¾‘ï¼',
                'path-reversed': 'è·¯å¾‘é †åºå·²åè½‰ï¼',
                'quick-path-preview': 'è·¯å¾‘é è¦½',
                'quick-export': 'å°å‡ºé¸é …',
                'quick-drawing': 'ç¹ªè£½æ¨¡å¼',
                
                // åœ˜éšŠæˆå“¡
                'member1-name': 'äºŒè°·é™å¸Œ',
                'member1-role': 'å…¨é¢é–‹ç™¼',
                'member1-tasks': 'ç³»çµ±æ¶æ§‹è¨­è¨ˆã€å…¨ç«¯åŠŸèƒ½é–‹ç™¼ã€æ¨¡çµ„æ•´åˆ',
                'member2-name': 'å»–ä¿Šæ¦®',
                'member2-role': 'åœ–ç‰‡è’é›†',
                'member2-tasks': 'è¦–è¦ºç´ æè’é›†ã€åœ–ç‰‡è³‡æºç®¡ç†ã€åª’é«”è³‡æ–™åº«å»ºç«‹',
                'member3-name': 'æ®·é Œğ¤‹®',
                'member3-role': 'å•é¡Œè™•ç†',
                'member3-tasks': 'ç³»çµ±ç•°å¸¸æ’é™¤ã€æŠ€è¡“å•é¡Œè§£æ±ºã€æ•…éšœä¿®å¾©',
                'member4-name': 'é»ƒæ¢“é‹’',
                'member4-role': 'å•é¡Œè™•ç†',
                'member4-tasks': 'å•é¡Œåˆ†æè¨ºæ–·ã€è§£æ±ºæ–¹æ¡ˆåˆ¶å®šã€æŠ€è¡“æ”¯æ´',
                'member5-name': 'é™³æ¢“ğ¨«¡',
                'member5-role': 'æ¸¬è©¦å·¥ç¨‹å¸«',
                'member5-tasks': 'æ¸¬è©¦æ¡ˆä¾‹åŸ·è¡Œã€ç¼ºé™·è¿½è¹¤ç®¡ç†ã€å“è³ªé©—è­‰',
                
                // æ•™å­¸å…§å®¹
                'tutorial-title': 'é›»å­åœ°åœ–ä½¿ç”¨æ•™å­¸',
                'tutorial-step1-title': 'å¦‚ä½•æ–°å¢åœ°é»',
                'tutorial-step1-desc': '1. å¡«å¯«åœ°é»åç¨±<br>2. è¼¸å…¥åº§æ¨™æˆ–ä½¿ç”¨åº§æ¨™æ‹¾å–å™¨<br>3. é¸æ“‡é€ è¨ªæ—¥æœŸ<br>4. æ·»åŠ åœ–ç‰‡ç¶²å€ï¼ˆå¯é¸ï¼‰<br>5. å¡«å¯«åœ°é»æè¿°<br>6. é¸æ“‡æ¨™è¨˜é¡è‰²<br>7. é»æ“Šã€Œæ–°å¢åœ°é»ã€æŒ‰éˆ•',
                'tutorial-step2-title': 'å¦‚ä½•ä½¿ç”¨åº§æ¨™æ‹¾å–å™¨',
                'tutorial-step2-desc': '1. é»æ“Šã€Œåº§æ¨™æ‹¾å–å™¨ã€é–‹é—œå•Ÿç”¨åŠŸèƒ½<br>2. åœ¨åœ°åœ–ä¸Šé»æ“Šæƒ³è¦æ¨™è¨˜çš„ä½ç½®<br>3. åº§æ¨™æœƒè‡ªå‹•å¡«å…¥è¡¨å–®ä¸­<br>4. ç¹¼çºŒå¡«å¯«å…¶ä»–è³‡è¨Šä¸¦æ–°å¢åœ°é»',
                'tutorial-step3-title': 'å¦‚ä½•ç¹ªè£½è·¯å¾‘',
                'tutorial-step3-desc': '1. é»æ“Šã€Œé–‹å§‹ç¹ªè£½ã€æŒ‰éˆ•<br>2. åœ¨åœ°åœ–ä¸Šé»æ“Šå¤šå€‹ä½ç½®æ·»åŠ è·¯å¾‘é»<br>3. é»æ“Šã€Œå®Œæˆç¹ªè£½ã€çµæŸç¹ªè£½<br>4. é»æ“Šã€Œè½‰æ›ç‚ºåœ°é»ã€å¯å°‡ç¹ªè£½é»è½‰ç‚ºåœ°é»<br>5. é»æ“Šã€Œæ¸…é™¤ã€å¯åˆªé™¤ç¹ªè£½çš„è·¯å¾‘',
                'tutorial-step4-title': 'å¦‚ä½•å°å‡ºè·¯å¾‘æ•¸æ“š',
                'tutorial-step4-desc': '1. ç¹ªè£½è·¯å¾‘æˆ–æ·»åŠ å¤šå€‹åœ°é»<br>2. é»æ“Šç›¸æ‡‰çš„å°å‡ºæŒ‰éˆ•ï¼š<br>   â€¢ GPXï¼šé€šç”¨GPSäº¤æ›æ ¼å¼<br>   â€¢ KMLï¼šGoogle Earthæ ¼å¼<br>   â€¢ GeoJSONï¼šWebåœ°åœ–å¸¸ç”¨æ ¼å¼',
                'tutorial-step5-title': 'å¦‚ä½•ä½¿ç”¨ç®­é ­è·¯å¾‘',
                'tutorial-step5-desc': '1. åœ¨åœ°åœ–è³‡è¨Šé ç±¤ä¸­é¸æ“‡ã€Œç®­é ­è·¯å¾‘ã€æ¨£å¼<br>2. èª¿æ•´ç®­é ­å¯†åº¦å’Œå¤§å°<br>3. é»æ“Šã€Œç®­é ­è·¯å¾‘ã€æŒ‰éˆ•ç‚ºç¾æœ‰è·¯å¾‘æ·»åŠ ç®­é ­<br>4. ç®­é ­æœƒè‡ªå‹•æŒ‡å‘è·¯å¾‘æ–¹å‘'
            },
            'en': {
                'app-title': 'Unity Team_Electronic Map',
                'app-subtitle': 'Support multiple map switching, customizable locations, images and text descriptions',
                'tab-locations': 'Location List',
                'tab-add': 'Add Location',
                'tab-maps': 'Map Selection',
                'tab-team': 'Team Members',
                'tab-info': 'System Information',
                'picker-label': 'Coordinate Picker',
                'picker-info': 'Click the "Coordinate Picker" switch above, then click on the map to get coordinates',
                'picker-active': 'Coordinate picker enabled! Click on the map to get coordinates',
                'picker-notification': 'Coordinates selected, filled in form',
                'btn-reset-view': 'Reset View',
                'btn-path': 'Toggle Path',
                'btn-show-all': 'Show All',
                'btn-my-location': 'My Location',
                'btn-drawing': 'Drawing Mode',
                'btn-arrow-path': 'Arrow Path',
                'btn-start-drawing': 'Start Drawing',
                'btn-finish-drawing': 'Finish Drawing',
                'btn-convert-points': 'Convert to Locations',
                'btn-clear-drawing': 'Clear',
                'add-title': 'Add Location',
                'label-name': 'Location Name *',
                'label-lat': 'Latitude *',
                'label-lng': 'Longitude *',
                'label-date': 'Visit Date',
                'label-image': 'Image URL',
                'label-description': 'Location Description',
                'label-color': 'Marker Color',
                'image-hint': 'You can use Unsplash images: https://images.unsplash.com/photo-...',
                'btn-submit': 'Add Location',
                'btn-clear': 'Clear Form',
                'btn-picker': 'Use Coordinate Picker',
                'maps-title': 'Select Map Type',
                'maps-desc': 'Click on the map providers below to switch between different map styles',
                'maps-tips-title': 'Map Tips',
                'maps-tip1': 'â€¢ OpenStreetMap is free and open source, no API key required',
                'maps-tip2': 'â€¢ All map types are free to use',
                'maps-tip3': 'â€¢ Some maps may load slowly, please be patient',
                'drawing-title': 'Path Drawing Tool',
                'drawing-desc': 'Click "Start Drawing" button, then click on the map or add points from location list to draw a custom path',
                'team-title': 'Team Members and Tasks',
                'timeline-title': 'Project Timeline',
                'project-title': 'Project Information',
                'project-desc': 'This project is the "Unity Team" electronic map system, aiming to provide a multifunctional, customizable map application supporting various map types, location markers, route planning, etc.',
                'project-feature1': 'â€¢ Support for 10+ map types',
                'project-feature2': 'â€¢ Complete multilingual support',
                'project-feature3': 'â€¢ Customizable markers and routes',
                'project-feature4': 'â€¢ Offline data storage function',
                'timeline-1': 'Project initiation and requirements analysis',
                'timeline-2': 'Map function development and testing',
                'timeline-3': 'Multilingual support and optimization',
                'timeline-4': 'Final testing and deployment',
                'info-title': 'System Information',
                'info-description': 'This electronic map system provides various map types, location markers, route planning and other functions, supporting offline use and local data storage.',
                'label-stat-locations': 'Location Markers',
                'label-stat-layers': 'Map Layers',
                'label-stat-languages': 'Supported Languages',
                'system-settings-title': 'System Settings',
                'label-language': 'Language Settings',
                'desc-language': 'Select the display language of the application',
                'feature1': 'Support for 10+ map types',
                'feature2': 'Complete multilingual support',
                'feature3': 'Customizable markers and routes',
                'feature4': 'Offline data storage function',
                'btn-apply': 'Apply All Settings',
                'btn-reset': 'Reset to Default',
                'btn-save': 'Save Settings',
                'export-gpx-name': 'GPX Format',
                'export-gpx-desc': 'Universal GPS exchange format',
                'export-kml-name': 'KML Format',
                'export-kml-desc': 'Google Earth format',
                'export-geojson-name': 'GeoJSON Format',
                'export-geojson-desc': 'Common web map format',
                'btn-export-gpx': 'Export GPX',
                'btn-export-kml': 'Export KML',
                'btn-export-geojson': 'Export GeoJSON',
                'footer-text': 'Electronic Map â€¢ Unity Teamï½Developerâ€”Haruki.Nâ€¢ Can be used offline â€¢ Last update: January 2026',
                'search-placeholder': 'Search locations...',
                'no-locations': 'No locations added yet',
                'location-added': 'Location successfully added!',
                'location-updated': 'Location successfully updated!',
                'location-deleted': 'Location deleted!',
                'confirm-delete': 'Are you sure you want to delete this location?',
                'path-hidden': 'Path hidden',
                'path-shown': 'Path shown',
                'path-need-more': 'Please add at least two locations to show path',
                'location-found': 'Your location found! Coordinates automatically filled in the form.',
                'location-error': 'Unable to get your location:',
                'location-unsupported': 'Your browser does not support geolocation.',
                'picker-enabled': 'Coordinate picker enabled! Please click on the map to get coordinates.',
                'edit-instruction': 'Please modify location information, then click "Update Location" button.',
                'drawing-started': 'Drawing mode enabled! Click on the map to add path points.',
                'drawing-finished': 'Path drawing completed!',
                'drawing-cleared': 'Drawing path cleared.',
                'drawing-need-more': 'Please add at least two points to draw a path.',
                'arrow-path-created': 'Arrow markers added to existing path!',
                'export-success': 'Path successfully exported!',
                'offline-mode': 'You are currently in offline mode, data will be stored locally.',
                'settings-applied': 'All settings applied!',
                'confirm-reset': 'Are you sure you want to reset all settings to default?',
                'settings-reset': 'All settings reset to default!',
                'points-converted': 'Drawing points successfully converted to locations!',
                'convert-confirm': 'Convert drawing points to locations and add to location list?',
                'convert-success': 'Successfully added {count} drawing points to location list!',
                'all-locations-added': 'All locations added to drawing path!',
                'path-reversed': 'Path order reversed!',
                'quick-path-preview': 'Path Preview',
                'quick-export': 'Export Options',
                'quick-drawing': 'Drawing Mode',
                'member1-name': 'Haruki Niya',
                'member1-role': 'Full Stack Developer',
                'member1-tasks': 'System architecture design, full-stack function development, module integration',
                'member2-name': 'Junrong Liao',
                'member2-role': 'Image Collection',
                'member2-tasks': 'Visual material collection, image resource management, media database establishment',
                'member3-name': 'Songxi Yin',
                'member3-role': 'Problem Handling',
                'member3-tasks': 'System exception handling, technical problem solving, fault repair',
                'member4-name': 'Zifeng Huang',
                'member4-role': 'Problem Handling',
                'member4-tasks': 'Problem analysis and diagnosis, solution development, technical support',
                'member5-name': 'Ziyan Chen',
                'member5-role': 'Test Engineer',
                'member5-tasks': 'Test case execution, defect tracking management, quality verification',
                'tutorial-title': 'Electronic Map Tutorial',
                'tutorial-step1-title': 'How to Add Locations',
                'tutorial-step1-desc': '1. Fill in location name<br>2. Enter coordinates or use coordinate picker<br>3. Select visit date<br>4. Add image URL (optional)<br>5. Fill in location description<br>6. Select marker color<br>7. Click "Add Location" button',
                'tutorial-step2-title': 'How to Use Coordinate Picker',
                'tutorial-step2-desc': '1. Click "Coordinate Picker" switch to enable<br>2. Click on the map where you want to mark<br>3. Coordinates will be auto-filled in the form<br>4. Continue filling other information and add location',
                'tutorial-step3-title': 'How to Draw Paths',
                'tutorial-step3-desc': '1. Click "Start Drawing" button<br>2. Click multiple positions on the map to add path points<br>3. Click "Finish Drawing" to end drawing<br>4. Click "Convert to Locations" to convert drawing points to locations<br>5. Click "Clear" to delete drawn path',
                'tutorial-step4-title': 'How to Export Path Data',
                'tutorial-step4-desc': '1. Draw a path or add multiple locations<br>2. Click corresponding export button:<br>   â€¢ GPX: Universal GPS exchange format<br>   â€¢ KML: Google Earth format<br>   â€¢ GeoJSON: Common web map format',
                'tutorial-step5-title': 'How to Use Arrow Paths',
                'tutorial-step5-desc': '1. Select "Arrow Path" style in Map Info tab<br>2. Adjust arrow density and size<br>3. Click "Arrow Path" button to add arrows to existing path<br>4. Arrows will automatically point in path direction'
            },
            'pt': {
                'app-title': 'Equipa Unida_Mapa EletrÃ³nico',
                'app-subtitle': 'Suporta mÃºltiplos tipos de mapas, localizaÃ§Ãµes personalizÃ¡veis, imagens e descriÃ§Ãµes de texto',
                'tab-locations': 'Lista de LocalizaÃ§Ãµes',
                'tab-add': 'Adicionar LocalizaÃ§Ã£o',
                'tab-maps': 'SeleÃ§Ã£o de Mapa',
                'tab-team': 'Lista de Tarefas',
                'tab-info': 'InformaÃ§Ã£o do Sistema',
                'picker-label': 'Seletor de Coordenadas',
                'picker-info': 'Clique no interruptor "Seletor de Coordenadas" acima e depois clique no mapa para obter coordenadas',
                'picker-active': 'Seletor de coordenadas ativado! Clique no mapa para obter coordenadas',
                'picker-notification': 'Coordenadas selecionadas, preenchidas no formulÃ¡rio',
                'btn-reset-view': 'Redefinir Vista',
                'btn-path': 'Alternar Caminho',
                'btn-show-all': 'Mostrar Todos',
                'btn-my-location': 'Minha LocalizaÃ§Ã£o',
                'btn-drawing': 'Modo Desenho',
                'btn-arrow-path': 'Caminho com Setas',
                'btn-start-drawing': 'ComeÃ§ar Desenho',
                'btn-finish-drawing': 'Terminar Desenho',
                'btn-convert-points': 'Converter para LocalizaÃ§Ãµes',
                'btn-clear-drawing': 'Limpar',
                'add-title': 'Adicionar LocalizaÃ§Ã£o',
                'label-name': 'Nome da LocalizaÃ§Ã£o *',
                'label-lat': 'Latitude *',
                'label-lng': 'Longitude *',
                'label-date': 'Data da Visita',
                'label-image': 'URL da Imagem',
                'label-description': 'DescriÃ§Ã£o da LocalizaÃ§Ã£o',
                'label-color': 'Cor do Marcador',
                'image-hint': 'Pode usar imagens Unsplash: https://images.unsplash.com/photo-...',
                'btn-submit': 'Adicionar LocalizaÃ§Ã£o',
                'btn-clear': 'Limpar FormulÃ¡rio',
                'btn-picker': 'Usar Seletor de Coordenadas',
                'maps-title': 'Selecionar Tipo de Mapa',
                'maps-desc': 'Clique nos fornecedores de mapa abaixo para alternar entre diferentes estilos de mapa',
                'maps-tips-title': 'Dicas do Mapa',
                'maps-tip1': 'â€¢ OpenStreetMap Ã© gratuito e de cÃ³digo aberto, sem necessidade de chave API',
                'maps-tip2': 'â€¢ Todos os tipos de mapa sÃ£o gratuitos',
                'maps-tip3': 'â€¢ Alguns mapas podem carregar lentamente, por favor seja paciente',
                'drawing-title': 'Ferramenta de Desenho de Caminho',
                'drawing-desc': 'Clique no botÃ£o "ComeÃ§ar Desenho", depois clique no mapa ou adicione pontos da lista de localizaÃ§Ãµes para desenhar um caminho personalizado',
                'team-title': 'Membros da Equipa e Tarefas',
                'timeline-title': 'Cronograma do Projeto',
                'project-title': 'InformaÃ§Ã£o do Projeto',
                'project-desc': 'Este projeto Ã© o sistema de mapa eletrÃ³nico "Equipa Unida", visando fornecer uma aplicaÃ§Ã£o de mapa multifuncional e personalizÃ¡vel, suportando vÃ¡rios tipos de mapa, marcadores de localizaÃ§Ã£o, planeamento de rotas, etc.',
                'project-feature1': 'â€¢ Suporte para 10+ tipos de mapa',
                'project-feature2': 'â€¢ Suporte multilingue completo',
                'project-feature3': 'â€¢ Marcadores e rotas personalizÃ¡veis',
                'project-feature4': 'â€¢ FunÃ§Ã£o de armazenamento de dados offline',
                'timeline-1': 'IniciaÃ§Ã£o do projeto e anÃ¡lise de requisitos',
                'timeline-2': 'Desenvolvimento e teste de funÃ§Ãµes de mapa',
                'timeline-3': 'Suporte multilingue e otimizaÃ§Ã£o',
                'timeline-4': 'Teste final e implementaÃ§Ã£o',
                'info-title': 'InformaÃ§Ã£o do Sistema',
                'info-description': 'Este sistema de mapa eletrÃ³nico fornece vÃ¡rios tipos de mapa, marcadores de localizaÃ§Ã£o, planeamento de rotas e outras funÃ§Ãµes, suportando uso offline e armazenamento local de dados.',
                'label-stat-locations': 'Marcadores de LocalizaÃ§Ã£o',
                'label-stat-layers': 'Camadas do Mapa',
                'label-stat-languages': 'Idiomas Suportados',
                'system-settings-title': 'ConfiguraÃ§Ãµes do Sistema',
                'label-language': 'ConfiguraÃ§Ãµes de Idioma',
                'desc-language': 'Selecione o idioma de exibiÃ§Ã£o da aplicaÃ§Ã£o',
                'feature1': 'Suporte para 10+ tipos de mapa',
                'feature2': 'Suporte multilingue completo',
                'feature3': 'Marcadores e rotas personalizÃ¡veis',
                'feature4': 'FunÃ§Ã£o de armazenamento de dados offline',
                'btn-apply': 'Aplicar Todas as ConfiguraÃ§Ãµes',
                'btn-reset': 'Redefinir para PadrÃ£o',
                'btn-save': 'Guardar ConfiguraÃ§Ãµes',
                'export-gpx-name': 'Formato GPX',
                'export-gpx-desc': 'Formato universal de troca GPS',
                'export-kml-name': 'Formato KML',
                'export-kml-desc': 'Formato do Google Earth',
                'export-geojson-name': 'Formato GeoJSON',
                'export-geojson-desc': 'Formato comum de mapas web',
                'btn-export-gpx': 'Exportar GPX',
                'btn-export-kml': 'Exportar KML',
                'btn-export-geojson': 'Exportar GeoJSON',
                'footer-text': 'Mapa EletrÃ³nico â€¢ Equipa Unidaï½Desenvolvedorâ€”Haruki.Nâ€¢ Pode ser usado offline â€¢ Ãšltima atualizaÃ§Ã£o: Janeiro 2026',
                'search-placeholder': 'Pesquisar localizaÃ§Ãµes...',
                'no-locations': 'Ainda nÃ£o foram adicionadas localizaÃ§Ãµes',
                'location-added': 'LocalizaÃ§Ã£o adicionada com sucesso!',
                'location-updated': 'LocalizaÃ§Ã£o atualizada com sucesso!',
                'location-deleted': 'LocalizaÃ§Ã£o eliminada!',
                'confirm-delete': 'Tem a certeza de que deseja eliminar esta localizaÃ§Ã£o?',
                'path-hidden': 'Caminho oculto',
                'path-shown': 'Caminho mostrado',
                'path-need-more': 'Por favor adicione pelo menos duas localizaÃ§Ãµes para mostrar o caminho',
                'location-found': 'A sua localizaÃ§Ã£o encontrada! Coordenadas automaticamente preenchidas no formulÃ¡rio.',
                'location-error': 'NÃ£o foi possÃ­vel obter a sua localizaÃ§Ã£o:',
                'location-unsupported': 'O seu navegador nÃ£o suporta geolocalizaÃ§Ã£o.',
                'picker-enabled': 'Seletor de coordenadas ativado! Por favor clique no mapa para obter coordenadas.',
                'edit-instruction': 'Por favor modifique a informaÃ§Ã£o da localizaÃ§Ã£o, depois clique no botÃ£o "Atualizar LocalizaÃ§Ã£o".',
                'drawing-started': 'Modo de desenho ativado! Clique no mapa para adicionar pontos de caminho.',
                'drawing-finished': 'Desenho do caminho concluÃ­do!',
                'drawing-cleared': 'Caminho de desenho limpo.',
                'drawing-need-more': 'Por favor adicione pelo menos dois pontos para desenhar um caminho.',
                'arrow-path-created': 'Marcadores de seta adicionados ao caminho existente!',
                'export-success': 'Caminho exportado com sucesso!',
                'offline-mode': 'Atualmente estÃ¡ em modo offline, os dados serÃ£o armazenados localmente.',
                'settings-applied': 'Todas as configuraÃ§Ãµes aplicadas!',
                'confirm-reset': 'Tem a certeza de que deseja redefinir todas as configuraÃ§Ãµes para o padrÃ£o?',
                'settings-reset': 'Todas as configuraÃ§Ãµes redefinidas para o padrÃ£o!',
                'points-converted': 'Pontos de desenho convertidos com sucesso para localizaÃ§Ãµes!',
                'convert-confirm': 'Converter pontos de desenho para localizaÃ§Ãµes e adicionar Ã  lista de localizaÃ§Ãµes?',
                'convert-success': 'Adicionados com sucesso {count} pontos de desenho Ã  lista de localizaÃ§Ãµes!',
                'all-locations-added': 'Todas as localizaÃ§Ãµes adicionadas ao caminho de desenho!',
                'path-reversed': 'Ordem do caminho invertida!',
                'quick-path-preview': 'PrÃ©-visualizaÃ§Ã£o do Caminho',
                'quick-export': 'OpÃ§Ãµes de ExportaÃ§Ã£o',
                'quick-drawing': 'Modo Desenho',
                'member1-name': 'Haruki Niya',
                'member1-role': 'Desenvolvimento Completo',
                'member1-tasks': 'Design de arquitetura do sistema, desenvolvimento de funÃ§Ãµes full-stack, integraÃ§Ã£o de mÃ³dulos',
                'member2-name': 'Junrong Liao',
                'member2-role': 'ColeÃ§Ã£o de Imagens',
                'member2-tasks': 'ColeÃ§Ã£o de material visual, gestÃ£o de recursos de imagem, estabelecimento de base de dados de mÃ­dia',
                'member3-name': 'Songxi Yin',
                'member3-role': 'Tratamento de Problemas',
                'member3-tasks': 'ResoluÃ§Ã£o de exceÃ§Ãµes do sistema, soluÃ§Ã£o de problemas tÃ©cnicos, reparaÃ§Ã£o de falhas',
                'member4-name': 'Zifeng Huang',
                'member4-role': 'Tratamento de Problemas',
                'member4-tasks': 'AnÃ¡lise e diagnÃ³stico de problemas, desenvolvimento de soluÃ§Ãµes, suporte tÃ©cnico',
                'member5-name': 'Ziyan Chen',
                'member5-role': 'Engenheiro de Testes',
                'member5-tasks': 'ExecuÃ§Ã£o de casos de teste, gestÃ£o de rastreamento de defeitos, verificaÃ§Ã£o de qualidade',
                'tutorial-title': 'Tutorial do Mapa EletrÃ³nico',
                'tutorial-step1-title': 'Como Adicionar LocalizaÃ§Ãµes',
                'tutorial-step1-desc': '1. Preencha o nome da localizaÃ§Ã£o<br>2. Insira coordenadas ou use o seletor de coordenadas<br>3. Selecione a data da visita<br>4. Adicione URL da imagem (opcional)<br>5. Preencha a descriÃ§Ã£o da localizaÃ§Ã£o<br>6. Selecione a cor do marcador<br>7. Clique no botÃ£o "Adicionar LocalizaÃ§Ã£o"',
                'tutorial-step2-title': 'Como Usar o Seletor de Coordenadas',
                'tutorial-step2-desc': '1. Clique no interruptor "Seletor de Coordenadas" para ativar<br>2. Clique no mapa onde deseja marcar<br>3. As coordenadas serÃ£o preenchidas automaticamente no formulÃ¡rio<br>4. Continue preenchendo outras informaÃ§Ãµes e adicione a localizaÃ§Ã£o',
                'tutorial-step3-title': 'Como Desenhar Caminhos',
                'tutorial-step3-desc': '1. Clique no botÃ£o "ComeÃ§ar Desenho"<br>2. Clique em vÃ¡rias posiÃ§Ãµes no mapa para adicionar pontos de caminho<br>3. Clique em "Terminar Desenho" para terminar<br>4. Clique em "Converter para LocalizaÃ§Ãµes" para converter pontos de desenho em localizaÃ§Ãµes<br>5. Clique em "Limpar" para apagar o caminho desenhado',
                'tutorial-step4-title': 'Como Exportar Dados de Caminho',
                'tutorial-step4-desc': '1. Desenhe um caminho ou adicione vÃ¡rias localizaÃ§Ãµes<br>2. Clique no botÃ£o de exportaÃ§Ã£o correspondente:<br>   â€¢ GPX: Formato universal de troca GPS<br>   â€¢ KML: Formato do Google Earth<br>   â€¢ GeoJSON: Formato comum de mapas web',
                'tutorial-step5-title': 'Como Usar Caminhos com Setas',
                'tutorial-step5-desc': '1. Selecione o estilo "Caminho com Setas" no separador InformaÃ§Ã£o do Mapa<br>2. Ajuste a densidade e tamanho das setas<br>3. Clique no botÃ£o "Caminho com Setas" para adicionar setas ao caminho existente<br>4. As setas apontarÃ£o automaticamente na direÃ§Ã£o do caminho'
            }
        };
        
        // ==================== åœ˜éšŠæˆå“¡è³‡æ–™ ====================
        const teamMembers = [
            {
                id: 1,
                name: 'äºŒè°·é™å¸Œ',
                role: 'å…¨é¢é–‹ç™¼',
                tasks: 'ç³»çµ±æ¶æ§‹è¨­è¨ˆã€å…¨ç«¯åŠŸèƒ½é–‹ç™¼ã€æ¨¡çµ„æ•´åˆ',
                color: '#3498db'
            },
            {
                id: 2,
                name: 'å»–ä¿Šæ¦®',
                role: 'åœ–ç‰‡è’é›†',
                tasks: 'è¦–è¦ºç´ æè’é›†ã€åœ–ç‰‡è³‡æºç®¡ç†ã€åª’é«”è³‡æ–™åº«å»ºç«‹',
                color: '#2ecc71'
            },
            {
                id: 3,
                name: 'æ®·é Œğ¤‹®',
                role: 'å•é¡Œè™•ç†',
                tasks: 'ç³»çµ±ç•°å¸¸æ’é™¤ã€æŠ€è¡“å•é¡Œè§£æ±ºã€æ•…éšœä¿®å¾©',
                color: '#e74c3c'
            },
            {
                id: 4,
                name: 'é»ƒæ¢“é‹’',
                role: 'å•é¡Œè™•ç†',
                tasks: 'å•é¡Œåˆ†æè¨ºæ–·ã€è§£æ±ºæ–¹æ¡ˆåˆ¶å®šã€æŠ€è¡“æ”¯æ´',
                color: '#9b59b6'
            },
            {
                id: 5,
                name: 'é™³æ¢“ğ¨«¡',
                role: 'æ¸¬è©¦å·¥ç¨‹å¸«',
                tasks: 'æ¸¬è©¦æ¡ˆä¾‹åŸ·è¡Œã€ç¼ºé™·è¿½è¹¤ç®¡ç†ã€å“è³ªé©—è­‰',
                color: '#f39c12'
            }
        ];
        
        // ==================== åˆå§‹åŒ–åœ°åœ– ====================
        let map;
        let currentMapLayer;
        const mapLayers = {};
        let locations = [];
        let markers = [];
        let pathLine = null;
        let activeLocationId = null;
        let isCoordinatePickerActive = false;
        let pickerMarker = null;
        let mapClickHandler = null;
        let mapSettings = {
            language: 'zh-TW',
            theme: 'light'
        };
        
        // ç¹ªè£½è·¯å¾‘ç›¸é—œè®Šæ•¸
        let isDrawingMode = false;
        let drawingPoints = [];
        let drawingLine = null;
        let drawingMarkers = [];
        let mapDrawingHandler = null;
        
        // ==================== åˆå§‹åŒ–æ‡‰ç”¨ç¨‹å¼ ====================
        function initApp() {
            // åˆå§‹åŒ–åœ°åœ–
            map = L.map('map').setView([22.1987, 113.5439], 12);
            
            // å®šç¾©åœ°åœ–åœ–å±¤
            mapLayers.osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: 'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                maxZoom: 19
            });
            
            mapLayers.osmHot = L.tileLayer('https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {
                attribution: 'Â© OpenStreetMap contributors, Tiles style by Humanitarian OpenStreetMap Team',
                maxZoom: 19
            });
            
            mapLayers.osmCycle = L.tileLayer('https://{s}.tile.thunderforest.com/cycle/{z}/{x}/{y}.png?apikey=1a9a81c0155a4c2898c6b698376b5d98', {
                attribution: 'Â© <a href="https://www.thunderforest.com/">Thunderforest</a>, Â© OpenStreetMap contributors',
                maxZoom: 19
            });
            
            mapLayers.osmTransport = L.tileLayer('https://{s}.tile.thunderforest.com/transport/{z}/{x}/{y}.png?apikey=1a9a81c0155a4c2898c6b698376b5d98', {
                attribution: 'Â© <a href="https://www.thunderforest.com/">Thunderforest</a>, Â© OpenStreetMap contributors',
                maxZoom: 19
            });
            
            mapLayers.cartoVoyager = L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
                attribution: 'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Â© <a href="https://carto.com/attributions">CARTO</a>',
                maxZoom: 19
            });
            
            mapLayers.cartoDark = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
                attribution: 'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Â© <a href="https://carto.com/attributions">CARTO</a>',
                maxZoom: 19
            });
            
            mapLayers.esriWorld = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
                attribution: 'Â© <a href="https://www.esri.com/">Esri</a>',
                maxZoom: 19
            });
            
            mapLayers.stadia = L.tileLayer('https://tiles.stadiamaps.com/tiles/alidade_smooth/{z}/{x}/{y}{r}.png', {
                attribution: 'Â© <a href="https://www.stadiamaps.com/" target="_blank">Stadia Maps</a> Â© <a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a> Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                maxZoom: 19
            });
            
            mapLayers.opentopomap = L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
                attribution: 'Â© <a href="https://opentopomap.org">OpenTopoMap</a> contributors',
                maxZoom: 17
            });
            
            mapLayers.wikimedia = L.tileLayer('https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}.png', {
                attribution: 'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Â© <a href="https://wikimediafoundation.org/">Wikimedia</a>',
                maxZoom: 19
            });
            
            // é è¨­ä½¿ç”¨ OpenStreetMap
            currentMapLayer = mapLayers.osm;
            currentMapLayer.addTo(map);
            
            // è¼‰å…¥å„²å­˜çš„è³‡æ–™
            loadFromLocalStorage();
            
            // å¦‚æœæ²’æœ‰åœ°é»è³‡æ–™ï¼Œä½¿ç”¨é è¨­è³‡æ–™
            if (locations.length === 0) {
                locations = [
                    {
                        id: 1,
                        name: "ç«¹ç£æµ·ç˜",
                        lat: 22.113469, 
                        lng: 113.561309,
                        date: "2025-12-27",
                        image: "1.jpg",
                        description: "1. ä½ èªç‚ºç«¹ç£æµ·ç˜çš„æµ·æ°´æ¸…æ¾ˆåº¦å¦‚ä½•ï¼Ÿ <br>åœ¨æŸç¨‹åº¦ä¸ŠæŸäº›å­£ç¯€æ°´è³ªæœƒæ¯”è¼ƒæ¸…ã€‚ä½†çµ•å¤§éƒ¨ä»½æ™‚å€™æ°´è³ªéƒ½æ˜¯æ¸¾æ¿çš„ï¼Œå› ç‚ºå®ƒæ˜¯æ³¥åº•ã€‚<br>2. ä½ è¦ºå¾—ç«¹ç£æµ·ç˜çš„ç’°å¢ƒèˆ‡è¡›ç”Ÿç‹€æ³å¦‚ä½•ï¼Ÿ<br>æ°´è³ªåŸºæœ¬ä¸Šéƒ½æ˜¯æ­£å¸¸å’Œä¹¾æ·¨çš„ï¼Œæ°´è³ªå·®æ˜¯å› ç‚ºå®ƒè¡¨é¢çœ‹ä¸Šå»é‚‹é¢ï¼Œä½†æ‰“å®Œé¢¨å¾Œæˆ–è€…æŸäº›å­£ç¯€åˆæˆ–è€…æœ‰ç´…æ½®å°±æœƒé‚‹é¢ã€‚",
                        color: "#2750F5"
                    },
                    {
                        id: 2,
                        name: "ç«¹ç£æµ·ç˜",
                        lat: 22.113605,
                        lng: 113.561022,
                        date: "2025-12-27",
                        image: "2.jpg",
                        description: "3. ç«¹ç£çš„ç’°å¢ƒè‡­ä¸è‡­ï¼Ÿ<br>è¦çœ‹æ˜¯ä»€éº¼æƒ…æ³ä¸‹ï¼Œä½†å¤§éƒ¨ä»½æ™‚å€™éƒ½ä¸è‡­<br>4. ä½ èªç‚ºç«¹ç£æµ·åŸŸæ±¡æŸ“åš´é‡å—ï¼Ÿ<br>æœ‰æ™‚æœƒæ¯”è¼ƒæ±¡æ¿ï¼Œä¸éå¯ä»¥æ¥å—",
                        color: "#6176C9"
                    },
                    {
                        id: 3,
                        name: "ç«¹ç£æµ·ç˜",
                        lat: 22.113342,
                        lng: 113.559509,
                        date: "2025-12-27",
                        image: "3.jpg",
                        description: "5. ä½ èªç‚ºç«¹ç£æµ·ç˜ç›®å‰æœ€éœ€è¦æ”¹å–„çš„æ–¹é¢æ˜¯ä»€éº¼ï¼Ÿï¼ˆä¾‹å¦‚ï¼šæ¸…æ½”ã€è¨­æ–½ã€å®‰å…¨ç­‰ï¼‰<br>æˆ‘èªç‚ºå¯ä»¥å¤šæ”¾å¹¾å¼µæ¤…å­åœ¨é™°æ¶¼çš„ä½ç½®ã€‚<br>6. ä¿‚ç«¹ç£æµ·ç˜åº¦ï¼Œä½ æœ€é¾æ„åšå˜…ä¸€ä»¶å°äº‹ä¿‚ä¹œï¼Ÿ<br>æˆ‘æœ€å–œæ­¡åœ¨é€™è£æ¸¸æ³³ã€‚",
                        color: "#34B80B"
                    },
                    {
                        id: 4,
                        name: "ç«¹ç£æµ·ç˜",
                        lat: 22.112572,
                        lng: 113.559029,
                        date: "2025-12-27",
                        image: "4.jpg",
                        description: "7. å¦‚æœç«¹ç£çš„æ°´è³ªèƒ½é€²ä¸€æ­¥æ”¹å–„ï¼Œæ‚¨æœ€å¸Œæœ›çœ‹åˆ°å“ªäº›å…·é«”è®ŠåŒ–ï¼ˆæ¯”å¦‚æ›´æ¸…æ¾ˆã€æ¸›å°‘åƒåœ¾ç­‰ï¼‰ï¼Ÿ<br>é€™è£å¯èƒ½æœƒæœ‰ä¸€äº›å¾®å°çš„ç»ç’ƒç¢æ¸£ï¼Œæˆ‘èªç‚ºéœ€è¦æ¸…ç†ä»–å€‘ï¼Œå› ç‚ºæˆ‘å€‘è‚‰çœ¼çœ‹ä¸è¦‹ï¼Œå®¹æ˜“è¸©åˆ°å—å‚·ã€‚<br>8. ä½ è¦ºå¾—ç«¹ç£æµ·ç˜ï¼ŒåŒæ¾³é–€å…¶ä»–æµ·ç˜æ¯”ï¼Œæœ‰å’©ç¨ç‰¹å˜…ç”Ÿæ´»å‘³é“ï¼Ÿ<br>æˆ‘è¦ºå¾—æŒºä¸éŒ¯ï¼Œæˆ‘å‰›å‰›å¾å¦å¤–ä¸€é‚Šå¾’æ­¥éä¾†ï¼Œè·¯é€”é‚„æŒºæ¼‚äº®çš„ï¼Œæ„Ÿè¦ºä¸€ä¸‹å­å¾ç¹è¯çš„éƒ½å¸‚ä¾†åˆ°äº†å¤§è‡ªç„¶ï¼Œç„¶å¾Œè¿é¢è€Œä¾†çš„æ˜¯æµ·çš„å‘³é“ï¼Œååˆ†æ–°é®®ã€‚",
                        color: "#FFA200"
                    },
                    {
                        id: 5,
                        name: "ç«¹ç£æµ·ç˜",
                        lat: 22.113121,
                        lng: 113.559308,
                        date: "2025-12-27",
                        image: "5.jpg",
                        description: "10. è©²æµ·ç˜çš„æµ·æ°´æº«åº¦èˆ‡å…¶ä»–æµ·ç˜ç›¸æ¯”ï¼Œæ˜¯å¦å­˜åœ¨æ˜é¡¯å·®ç•°ï¼Ÿ<br>æˆ‘è¦ºå¾—é€™å€‹æµ·ç˜çš„æµ·æ°´æº«åº¦æœƒæ¯”å…¶ä»–æµ·ç˜çš„æµ·æ°´æº«åº¦é«˜ä¸€é»",
                        color: "#C300FF"
                    },
                    {
                        id: 6,
                        name: "ç«¹ç£æµ·ç˜",
                        lat: 22.113116,
                        lng: 113.559137,
                        date: "2025-12-27",
                        image: "6.jpg",
                        description: "9. æ‚¨å¹³æ™‚æœ‰è§€å¯Ÿéé»‘æ²™ç’°å‘¨é‚Šæ°´åŸŸï¼ˆå¦‚æµ·é‚Šã€æ²³é“ï¼‰çš„æ°´è³ªæƒ…æ³å—ï¼Ÿæ‚¨è¦ºå¾—å®ƒç›®å‰æ•´é«”æ€éº¼æ¨£ï¼Ÿ<br>é€™è£æœ‰å¾ˆå¤šçš„åƒåœ¾ï¼Œæˆ‘èªç‚ºéœ€è¦æ¸…ç†ä¸€ä¸‹å®ƒå€‘ã€‚",
                        color: "#e74c3c"
                    }
                ];
            }
            
            // åˆå§‹åŒ–åœ°åœ–æ¨™è¨˜
            initMap();
            
            // è¨­ç½®æ—¥æœŸé è¨­å€¼
            document.getElementById('date').value = new Date().toISOString().split('T')[0];
            
            // æ›´æ–°åœ°åœ–æä¾›å•†å¡ç‰‡
            updateProviderCards('osm');
            
            // æ›´æ–°åœ˜éšŠæˆå“¡é¡¯ç¤º
            updateTeamDisplay();
            
            // è¨­å®šæœå°‹æ¡†æç¤º
            document.getElementById('locationSearch').placeholder = getTranslation('search-placeholder');
            
            // æ›´æ–°æ‰€æœ‰ä»‹é¢æ–‡å­—
            updateInterfaceText(mapSettings.language);
            
            // è¨­ç½®èªè¨€é¸æ“‡å™¨
            const langSelect = document.getElementById('appLanguage');
            if (langSelect) {
                langSelect.value = mapSettings.language;
            }
            
            console.log('æ‡‰ç”¨ç¨‹å¼åˆå§‹åŒ–å®Œæˆï¼');
        }
        
        // ==================== åœ°åœ–åŠŸèƒ½ ====================
        function initMap() {
            // æ¸…é™¤ç¾æœ‰æ¨™è¨˜
            markers.forEach(marker => {
                map.removeLayer(marker.marker);
            });
            markers = [];
            
            // æ·»åŠ æ‰€æœ‰åœ°é»æ¨™è¨˜
            locations.forEach(location => {
                addMarkerToMap(location);
            });
            
            // ç¹ªè£½è·¯å¾‘
            drawPath();
            
            // æ›´æ–°åœ°é»åˆ—è¡¨
            updateLocationList();
            
            // å¦‚æœæœ‰å¤šå€‹åœ°é»ï¼Œé¡¯ç¤ºæ‰€æœ‰æ¨™è¨˜
            if (locations.length > 0) {
                showAllMarkers();
            }
            
            // æ›´æ–°ç³»çµ±è³‡è¨Š
            updateSystemInfo();
        }
        
        function addMarkerToMap(location) {
            const marker = L.marker([location.lat, location.lng], {
                icon: createCustomIcon(location.id, location.color)
            }).addTo(map);
            
            const popupContent = `
                <div style="max-width: 250px;">
                    <h3 style="margin-top: 0; color: ${location.color};">${location.name}</h3>
                    <img src="${location.image || 'https://images.unsplash.com/photo-1552465011-b4e30bf7349d?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80'}" 
                         alt="${location.name}" 
                         style="width:100%; height:150px; object-fit:cover; border-radius:5px;">
                    <p><strong>æ—¥æœŸï¼š</strong>${location.date || 'æœªæŒ‡å®š'}</p>
                    <p>${location.description ? location.description.substring(0, 100) + '...' : 'ç„¡æè¿°'}</p>
                    <button onclick="showLocationDetail(${location.id})" 
                            style="background:${location.color}; color:white; border:none; padding:5px 10px; border-radius:3px; cursor:pointer; margin-top:5px;">
                        æŸ¥çœ‹è©³æƒ…
                    </button>
                </div>
            `;
            
            marker.bindPopup(popupContent);
            marker.on('click', function() {
                showLocationDetail(location.id);
            });
            
            markers.push({
                id: location.id,
                marker: marker,
                lat: location.lat,
                lng: location.lng
            });
        }
        
        function createCustomIcon(id, color) {
            return L.divIcon({
                html: `<div class="custom-marker" style="background-color:${color};">${id}</div>`,
                className: 'custom-div-icon',
                iconSize: [28, 28],
                iconAnchor: [14, 14]
            });
        }
        
        function drawPath() {
            // æ¸…é™¤ç¾æœ‰çš„è·¯å¾‘
            if (pathLine) {
                map.removeLayer(pathLine);
            }
            
            if (locations.length < 2) {
                pathLine = null;
                return;
            }
            
            const sortedLocations = [...locations].sort((a, b) => a.id - b.id);
            const pathCoordinates = sortedLocations.map(loc => [loc.lat, loc.lng]);
            
            pathLine = L.polyline(pathCoordinates, {
                color: '#3498db',
                weight: 4,
                opacity: 0.7,
                dashArray: '10, 10'
            }).addTo(map);
        }
        
        function togglePath() {
            if (pathLine) {
                if (map.hasLayer(pathLine)) {
                    map.removeLayer(pathLine);
                    alert(getTranslation('path-hidden'));
                } else {
                    pathLine.addTo(map);
                    alert(getTranslation('path-shown'));
                }
            } else {
                alert(getTranslation('path-need-more'));
            }
        }
        
        function changeMapType(mapType) {
            if (mapLayers[mapType]) {
                map.removeLayer(currentMapLayer);
                currentMapLayer = mapLayers[mapType];
                currentMapLayer.addTo(map);
                updateProviderCards(mapType);
                document.getElementById('mapType').value = mapType;
            }
        }
        
        function selectMapProvider(mapType) {
            changeMapType(mapType);
            switchTab('locations');
        }
        
        function updateProviderCards(activeMapType) {
            document.querySelectorAll('.provider-card').forEach(card => {
                card.classList.remove('active');
            });
            
            const providerCards = document.querySelectorAll('.provider-card');
            for (let card of providerCards) {
                if (card.onclick && card.onclick.toString().includes(`'${activeMapType}'`)) {
                    card.classList.add('active');
                    break;
                }
            }
        }
        
        // ==================== åœ°é»ç®¡ç† ====================
        function addLocation() {
            const name = document.getElementById('name').value;
            const lat = parseFloat(document.getElementById('lat').value);
            const lng = parseFloat(document.getElementById('lng').value);
            const date = document.getElementById('date').value;
            const image = document.getElementById('image').value;
            const description = document.getElementById('description').value;
            const color = document.getElementById('color').value;
            
            if (!name || isNaN(lat) || isNaN(lng)) {
                alert('è«‹å¡«å¯«åœ°é»åç¨±å’Œæœ‰æ•ˆçš„åº§æ¨™ï¼');
                return;
            }
            
            const newId = locations.length > 0 ? Math.max(...locations.map(loc => loc.id)) + 1 : 1;
            
            const newLocation = {
                id: newId,
                name,
                lat,
                lng,
                date: date || new Date().toISOString().split('T')[0],
                image: image || 'https://images.unsplash.com/photo-1552465011-b4e30bf7349d?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80',
                description: description || 'ç„¡æè¿°',
                color: color || '#3498db'
            };
            
            locations.push(newLocation);
            addMarkerToMap(newLocation);
            drawPath();
            updateLocationList();
            switchTab('locations');
            showLocationDetail(newId);
            saveToLocalStorage();
            clearForm();
            
            alert(getTranslation('location-added'));
            updateSystemInfo();
        }
        
        function updateLocationList() {
            const locationList = document.getElementById('locationList');
            if (!locationList) return;
            
            locationList.innerHTML = '';
            
            if (locations.length === 0) {
                locationList.innerHTML = `<p class="empty-state">${getTranslation('no-locations')}</p>`;
                return;
            }
            
            const sortedLocations = [...locations].sort((a, b) => a.id - b.id);
            
            sortedLocations.forEach(location => {
                const card = document.createElement('div');
                card.className = 'location-card';
                if (location.id === activeLocationId) {
                    card.classList.add('active');
                }
                card.id = `location-card-${location.id}`;
                
                card.innerHTML = `
                    <div class="location-title">
                        <span class="location-name">${location.name}</span>
                        <span class="location-date">${location.date || 'ç„¡æ—¥æœŸ'}</span>
                    </div>
                    <img class="location-img" src="${location.image || 'https://images.unsplash.com/photo-1552465011-b4e30bf7349d?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80'}" alt="${location.name}">
                    <p class="location-desc">${location.description || 'ç„¡æè¿°'}</p>
                    <div class="location-coords">åº§æ¨™: ${location.lat.toFixed(6)}, ${location.lng.toFixed(6)}</div>
                    <div class="card-actions">
                        <button class="action-btn edit-btn" onclick="editLocation(${location.id})">ç·¨è¼¯</button>
                        <button class="action-btn delete-btn" onclick="deleteLocation(${location.id})">åˆªé™¤</button>
                    </div>
                `;
                
                card.addEventListener('click', (e) => {
                    if (!e.target.classList.contains('action-btn')) {
                        showLocationDetail(location.id);
                    }
                });
                
                locationList.appendChild(card);
            });
        }
        
        function searchLocations() {
            const searchTerm = document.getElementById('locationSearch').value.toLowerCase();
            const locationCards = document.querySelectorAll('.location-card');
            
            locationCards.forEach(card => {
                const locationName = card.querySelector('.location-name').textContent.toLowerCase();
                const locationDesc = card.querySelector('.location-desc').textContent.toLowerCase();
                
                if (locationName.includes(searchTerm) || locationDesc.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }
        
        function showLocationDetail(locationId) {
            const location = locations.find(loc => loc.id === locationId);
            if (!location) return;
            
            activeLocationId = locationId;
            updateLocationList();
            
            map.flyTo([location.lat, location.lng], 12, {
                duration: 1.5
            });
            
            const marker = markers.find(m => m.id === locationId);
            if (marker) {
                marker.marker.openPopup();
            }
        }
        
        function editLocation(locationId) {
            event.stopPropagation();
            
            const location = locations.find(loc => loc.id === locationId);
            if (!location) return;
            
            document.getElementById('name').value = location.name;
            document.getElementById('lat').value = location.lat;
            document.getElementById('lng').value = location.lng;
            document.getElementById('date').value = location.date || '';
            document.getElementById('image').value = location.image || '';
            document.getElementById('description').value = location.description || '';
            document.getElementById('color').value = location.color || '#3498db';
            
            switchTab('add');
            
            const submitBtn = document.getElementById('btn-submit');
            submitBtn.textContent = 'æ›´æ–°åœ°é»';
            submitBtn.onclick = function() {
                updateLocation(locationId);
            };
            
            map.flyTo([location.lat, location.lng], 12, {
                duration: 1.5
            });
            
            alert(getTranslation('edit-instruction'));
        }
        
        function updateLocation(locationId) {
            const name = document.getElementById('name').value;
            const lat = parseFloat(document.getElementById('lat').value);
            const lng = parseFloat(document.getElementById('lng').value);
            const date = document.getElementById('date').value;
            const image = document.getElementById('image').value;
            const description = document.getElementById('description').value;
            const color = document.getElementById('color').value;
            
            if (!name || isNaN(lat) || isNaN(lng)) {
                alert('è«‹å¡«å¯«åœ°é»åç¨±å’Œæœ‰æ•ˆçš„åº§æ¨™ï¼');
                return;
            }
            
            const locationIndex = locations.findIndex(loc => loc.id === locationId);
            if (locationIndex === -1) return;
            
            locations[locationIndex] = {
                id: locationId,
                name,
                lat,
                lng,
                date: date || new Date().toISOString().split('T')[0],
                image: image || 'https://images.unsplash.com/photo-1552465011-b4e30bf7349d?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80',
                description: description || 'ç„¡æè¿°',
                color: color || '#3498db'
            };
            
            initMap();
            switchTab('locations');
            
            const submitBtn = document.getElementById('btn-submit');
            submitBtn.textContent = getTranslation('btn-submit');
            submitBtn.onclick = addLocation;
            
            saveToLocalStorage();
            clearForm();
            
            alert(getTranslation('location-updated'));
            updateSystemInfo();
        }
        
        function deleteLocation(locationId) {
            event.stopPropagation();
            
            if (!confirm(getTranslation('confirm-delete'))) {
                return;
            }
            
            const locationIndex = locations.findIndex(loc => loc.id === locationId);
            if (locationIndex !== -1) {
                locations.splice(locationIndex, 1);
            }
            
            initMap();
            saveToLocalStorage();
            
            alert(getTranslation('location-deleted'));
            updateSystemInfo();
        }
        
        function clearForm() {
            document.getElementById('locationForm').reset();
            document.getElementById('color').value = '#3498db';
            document.getElementById('date').value = new Date().toISOString().split('T')[0];
            
            const submitBtn = document.getElementById('btn-submit');
            submitBtn.textContent = getTranslation('btn-submit');
            submitBtn.onclick = addLocation;
            
            disableCoordinatePicker();
            const pickerToggle = document.getElementById('coordinatePickerToggle');
            if (pickerToggle) pickerToggle.checked = false;
        }
        
        // ==================== å…¶ä»–åŠŸèƒ½ ====================
        function resetMap() {
            map.flyTo([22.1987, 113.5439], 12, {
                duration: 1.5
            });
            
            markers.forEach(m => m.marker.closePopup());
            activeLocationId = null;
            updateLocationList();
            disableCoordinatePicker();
            const pickerToggle = document.getElementById('coordinatePickerToggle');
            if (pickerToggle) pickerToggle.checked = false;
        }
        
        function showAllMarkers() {
            if (locations.length === 0) {
                alert(getTranslation('no-locations'));
                return;
            }
            
            const bounds = L.latLngBounds([]);
            locations.forEach(loc => bounds.extend([loc.lat, loc.lng]));
            map.flyToBounds(bounds, { padding: [50, 50], duration: 2 });
        }
        
        function getCurrentLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    function(position) {
                        const lat = position.coords.latitude;
                        const lng = position.coords.longitude;
                        
                        map.flyTo([lat, lng], 14, {
                            duration: 1.5
                        });
                        
                        const marker = L.marker([lat, lng]).addTo(map);
                        marker.bindPopup('æ‚¨çš„ç•¶å‰ä½ç½®').openPopup();
                        
                        document.getElementById('lat').value = lat.toFixed(6);
                        document.getElementById('lng').value = lng.toFixed(6);
                        
                        if (!document.getElementById('name').value) {
                            document.getElementById('name').value = 'æˆ‘çš„ä½ç½®';
                        }
                        
                        alert(getTranslation('location-found'));
                    },
                    function(error) {
                        alert(getTranslation('location-error') + error.message);
                    }
                );
            } else {
                alert(getTranslation('location-unsupported'));
            }
        }
        
        function createArrowPathFromLocations() {
            if (locations.length < 2) {
                alert('è«‹å…ˆæ·»åŠ è‡³å°‘å…©å€‹åœ°é»');
                return;
            }
            
            alert(getTranslation('arrow-path-created'));
        }
        
        // ==================== åº§æ¨™æ‹¾å–å™¨åŠŸèƒ½ ====================
        function toggleCoordinatePicker() {
            const pickerToggle = document.getElementById('coordinatePickerToggle');
            
            if (pickerToggle.checked) {
                enableCoordinatePicker();
            } else {
                disableCoordinatePicker();
            }
        }
        
        function enableCoordinatePicker() {
            isCoordinatePickerActive = true;
            
            const addTab = document.querySelector('.tab[onclick="switchTab(\'add\')"]');
            if (!addTab.classList.contains('active')) {
                addTab.click();
            }
            
            const infoElement = document.getElementById('coordPickerInfo');
            if (infoElement) {
                infoElement.textContent = getTranslation('picker-active');
            }
            
            mapClickHandler = function(e) {
                const lat = e.latlng.lat;
                const lng = e.latlng.lng;
                
                document.getElementById('lat').value = lat.toFixed(6);
                document.getElementById('lng').value = lng.toFixed(6);
                
                if (pickerMarker) {
                    map.removeLayer(pickerMarker);
                }
                
                pickerMarker = L.marker([lat, lng], {
                    icon: L.divIcon({
                        html: '<div class="picker-marker"></div>',
                        className: 'picker-div-icon',
                        iconSize: [30, 30],
                        iconAnchor: [15, 15]
                    })
                }).addTo(map);
                
                showCoordinateNotification(getTranslation('picker-notification'));
                
                map.flyTo([lat, lng], Math.max(map.getZoom(), 12), {
                    duration: 0.5
                });
            };
            
            map.on('click', mapClickHandler);
            document.querySelector('.map-section').classList.add('picker-mode-active');
        }
        
        function disableCoordinatePicker() {
            isCoordinatePickerActive = false;
            
            if (mapClickHandler) {
                map.off('click', mapClickHandler);
                mapClickHandler = null;
            }
            
            if (pickerMarker) {
                map.removeLayer(pickerMarker);
                pickerMarker = null;
            }
            
            const infoElement = document.getElementById('coordPickerInfo');
            if (infoElement) {
                infoElement.textContent = getTranslation('picker-info');
            }
            
            document.querySelector('.map-section').classList.remove('picker-mode-active');
        }
        
        function showCoordinateNotification(message) {
            const notification = document.getElementById('coordinateNotification');
            if (notification) {
                notification.textContent = message;
                notification.style.display = 'block';
                
                setTimeout(() => {
                    notification.style.display = 'none';
                }, 3000);
            }
        }
        
        function useCoordinatePicker() {
            document.getElementById('coordinatePickerToggle').checked = true;
            toggleCoordinatePicker();
            alert(getTranslation('picker-enabled'));
        }
        
        // ==================== èªè¨€åŠŸèƒ½ ====================
        function changeLanguage(lang) {
            mapSettings.language = lang;
            
            // æ›´æ–°æ‰€æœ‰ä»‹é¢æ–‡å­—
            updateInterfaceText(lang);
            
            // å„²å­˜è¨­å®š
            saveSettings();
            
            // æ›´æ–°åœ˜éšŠæˆå“¡é¡¯ç¤º
            updateTeamDisplay();
            
            // æ›´æ–°ç³»çµ±è³‡è¨Š
            updateSystemInfo();
            
            alert('èªè¨€å·²æ›´æ”¹ç‚º: ' + getLanguageName(lang));
        }
        
        function getLanguageName(langCode) {
            const languageNames = {
                'zh-TW': 'ç¹é«”ä¸­æ–‡',
                'en': 'English',
                'pt': 'PortuguÃªs'
            };
            return languageNames[langCode] || langCode;
        }
        
        function updateInterfaceText(lang) {
            const t = translations[lang] || translations['zh-TW'];
            
            // æ›´æ–°æ‰€æœ‰å¸¶æœ‰IDçš„å…ƒç´ æ–‡å­—
            for (const key in t) {
                const element = document.getElementById(key);
                if (element) {
                    if (key === 'image-hint' || key.startsWith('maps-tip') || 
                        key.startsWith('project-feature') || key.startsWith('timeline-') ||
                        key.startsWith('desc-') || key.startsWith('label-') || 
                        key.startsWith('feature') || key === 'drawing-title' || 
                        key === 'drawing-desc') {
                        element.textContent = t[key];
                    } else if (element.tagName === 'INPUT' && element.type === 'text') {
                        element.placeholder = t[key];
                    } else {
                        element.textContent = t[key];
                    }
                }
            }
            
            // æ›´æ–°è¡¨å–®æŒ‰éˆ•æ–‡å­—ï¼ˆå¦‚æœæ­£åœ¨ç·¨è¼¯ï¼‰
            const submitBtn = document.getElementById('btn-submit');
            if (submitBtn && submitBtn.textContent.includes('æ›´æ–°')) {
                submitBtn.textContent = 'æ›´æ–°åœ°é»';
            }
        }
        
        function getTranslation(key) {
            return translations[mapSettings.language] ? 
                   translations[mapSettings.language][key] : 
                   translations['zh-TW'][key];
        }
        
        // ==================== åœ˜éšŠæˆå“¡é¡¯ç¤º ====================
        function updateTeamDisplay() {
            const teamGrid = document.getElementById('team-grid');
            if (!teamGrid) return;
            
            teamGrid.innerHTML = '';
            
            teamMembers.forEach(member => {
                const memberElement = document.createElement('div');
                memberElement.className = 'team-member';
                memberElement.innerHTML = `
                    <div class="member-avatar" style="background: ${member.color}">${member.name.charAt(0)}</div>
                    <div class="member-name">${getTranslation(`member${member.id}-name`)}</div>
                    <div class="member-role">${getTranslation(`member${member.id}-role`)}</div>
                    <div class="member-tasks">${getTranslation(`member${member.id}-tasks`)}</div>
                `;
                teamGrid.appendChild(memberElement);
            });
            
            // æ›´æ–°çµ±è¨ˆ
            document.getElementById('total-members').textContent = teamMembers.length;
            document.getElementById('total-tasks').textContent = teamMembers.reduce((sum, member) => sum + member.tasks.split('ã€').length, 0);
        }
        
        // ==================== é ç±¤åˆ‡æ›åŠŸèƒ½ ====================
        function switchTab(tabName) {
            // æ›´æ–°é ç±¤æŒ‰éˆ•ç‹€æ…‹
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // é¡¯ç¤ºå°æ‡‰çš„å…§å®¹
            document.querySelectorAll('.tab-pane').forEach(pane => {
                pane.classList.remove('active');
            });
            document.getElementById(`${tabName}-tab`).classList.add('active');
            
            // å¦‚æœé›¢é–‹æ–°å¢é ç±¤ï¼Œé—œé–‰åº§æ¨™æ‹¾å–å™¨
            if (tabName !== 'add') {
                disableCoordinatePicker();
                const pickerToggle = document.getElementById('coordinatePickerToggle');
                if (pickerToggle) pickerToggle.checked = false;
            }
            
            // å¦‚æœåˆ‡æ›åˆ°åˆ†å·¥åå–®é ç±¤ï¼Œæ›´æ–°åœ˜éšŠé¡¯ç¤º
            if (tabName === 'team') {
                updateTeamDisplay();
            }
            
            // å¦‚æœåˆ‡æ›åˆ°ç³»çµ±è³‡è¨Šé ç±¤ï¼Œæ›´æ–°å…§å®¹
            if (tabName === 'info') {
                updateSystemInfo();
            }
        }
        
        // ==================== ç¹ªè£½è·¯å¾‘åŠŸèƒ½ ====================
        function startDrawing() {
            isDrawingMode = true;
            enableDrawingMode();
            document.getElementById('quick-drawing').classList.add('active');
            alert(getTranslation('drawing-started'));
        }
        
        function enableDrawingMode() {
            mapDrawingHandler = function(e) {
                const lat = e.latlng.lat;
                const lng = e.latlng.lng;
                
                addDrawingPoint(lat, lng);
            };
            
            map.on('click', mapDrawingHandler);
            document.querySelector('.map-section').classList.add('picker-mode-active');
        }
        
        function addDrawingPoint(lat, lng) {
            drawingPoints.push({ lat, lng });
            
            // åœ¨åœ°åœ–ä¸Šæ·»åŠ æ¨™è¨˜
            const marker = L.marker([lat, lng], {
                icon: L.divIcon({
                    html: '<div style="background-color: #9b59b6; width: 15px; height: 15px; border-radius: 50%; border: 2px solid white; box-shadow: 0 0 5px rgba(0,0,0,0.5);"></div>',
                    className: 'drawing-marker',
                    iconSize: [19, 19],
                    iconAnchor: [9, 9]
                })
            }).addTo(map);
            drawingMarkers.push(marker);
            
            // æ›´æ–°ç¹ªè£½é»åˆ—è¡¨
            updateDrawingPointList();
            
            // å¦‚æœæœ‰å¤šå€‹é»ï¼Œç¹ªè£½ç·šæ¢
            if (drawingPoints.length > 1) {
                updateDrawingLine();
            }
            
            // æ›´æ–°è·¯å¾‘é è¦½é¢æ¿
            updatePathPreviewPanel();
            
            // ä¿å­˜åˆ°æœ¬åœ°å„²å­˜
            saveToLocalStorage();
        }
        
        function finishDrawing() {
            if (drawingPoints.length < 2) {
                alert(getTranslation('drawing-need-more'));
                return;
            }
            
            alert(getTranslation('drawing-finished'));
            
            // é—œé–‰ç¹ªè£½æ¨¡å¼
            isDrawingMode = false;
            disableDrawingMode();
            document.getElementById('quick-drawing').classList.remove('active');
        }
        
        function disableDrawingMode() {
            if (mapDrawingHandler) {
                map.off('click', mapDrawingHandler);
                mapDrawingHandler = null;
            }
            
            document.querySelector('.map-section').classList.remove('picker-mode-active');
        }
        
        function convertDrawingPointsToLocations() {
            if (drawingPoints.length === 0) {
                alert('æ²’æœ‰å¯è½‰æ›çš„ç¹ªè£½é»');
                return;
            }
            
            if (confirm(getTranslation('convert-confirm'))) {
                // è¨ˆç®—æ–°åœ°é»çš„èµ·å§‹ID
                const maxId = locations.length > 0 ? Math.max(...locations.map(loc => loc.id)) : 0;
                
                // å°‡ç¹ªè£½é»è½‰æ›ç‚ºåœ°é»
                drawingPoints.forEach((point, index) => {
                    const newId = maxId + index + 1;
                    const newLocation = {
                        id: newId,
                        name: `${getTranslation('drawing-title')} ${index + 1}`,
                        lat: point.lat,
                        lng: point.lng,
                        date: new Date().toISOString().split('T')[0],
                        image: 'https://images.unsplash.com/photo-1552465011-b4e30bf7349d?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80',
                        description: `${getTranslation('drawing-desc')} #${index + 1}`,
                        color: '#9b59b6'
                    };
                    
                    locations.push(newLocation);
                    addMarkerToMap(newLocation);
                });
                
                // é‡æ–°ç¹ªè£½è·¯å¾‘ä¸¦æ›´æ–°æ¸…å–®
                drawPath();
                updateLocationList();
                saveToLocalStorage();
                
                // é¡¯ç¤ºæˆåŠŸè¨Šæ¯
                const successMsg = getTranslation('convert-success').replace('{count}', drawingPoints.length);
                alert(successMsg);
                
                // æ¸…é™¤ç¹ªè£½é»
                clearDrawing();
            }
        }
        
        function clearDrawing() {
            // æ¸…é™¤ç¹ªè£½æ¨™è¨˜
            drawingMarkers.forEach(marker => {
                map.removeLayer(marker);
            });
            drawingMarkers = [];
            
            // æ¸…é™¤ç¹ªè£½ç·šæ¢
            if (drawingLine) {
                map.removeLayer(drawingLine);
                drawingLine = null;
            }
            
            // æ¸…ç©ºç¹ªè£½é»é™£åˆ—
            drawingPoints = [];
            
            // æ›´æ–°ç¹ªè£½é»åˆ—è¡¨
            updateDrawingPointList();
            
            // é—œé–‰ç¹ªè£½æ¨¡å¼
            isDrawingMode = false;
            disableDrawingMode();
            document.getElementById('quick-drawing').classList.remove('active');
            
            // æ›´æ–°è·¯å¾‘é è¦½é¢æ¿
            updatePathPreviewPanel();
            
            alert(getTranslation('drawing-cleared'));
        }
        
        function updateDrawingLine() {
            // æ¸…é™¤ç¾æœ‰çš„ç¹ªè£½ç·šæ¢
            if (drawingLine) {
                map.removeLayer(drawingLine);
            }
            
            // å‰µå»ºæ–°çš„ç·šæ¢
            const coordinates = drawingPoints.map(point => [point.lat, point.lng]);
            drawingLine = L.polyline(coordinates, {
                color: '#9b59b6',
                weight: 3,
                opacity: 0.7,
                dashArray: '5, 5'
            }).addTo(map);
        }
        
        function updateDrawingPointList() {
            const pointList = document.getElementById('drawingPointList');
            if (!pointList) return;
            
            pointList.innerHTML = '';
            
            if (drawingPoints.length === 0) {
                pointList.innerHTML = '<p style="text-align: center; color: #7f8c8d; padding: 10px;">å°šæœªæ·»åŠ ä»»ä½•é»</p>';
                return;
            }
            
            drawingPoints.forEach((point, index) => {
                const pointItem = document.createElement('div');
                pointItem.className = 'drawing-point-item';
                
                pointItem.innerHTML = `
                    <div style="flex: 1;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <strong>é» ${index + 1}</strong>
                            <button class="action-btn delete-btn btn-small" onclick="removeDrawingPoint(${index})">åˆªé™¤</button>
                        </div>
                        <div style="font-size: 0.8rem; color: #7f8c8d; margin-top: 3px;">
                            åº§æ¨™: ${point.lat.toFixed(6)}, ${point.lng.toFixed(6)}
                        </div>
                    </div>
                `;
                
                pointList.appendChild(pointItem);
            });
        }
        
        function removeDrawingPoint(index) {
            if (index >= 0 && index < drawingPoints.length) {
                // ç§»é™¤æ¨™è¨˜
                if (drawingMarkers[index]) {
                    map.removeLayer(drawingMarkers[index]);
                    drawingMarkers.splice(index, 1);
                }
                
                // ç§»é™¤é»
                drawingPoints.splice(index, 1);
                
                // æ›´æ–°ç·šæ¢
                if (drawingPoints.length > 1) {
                    updateDrawingLine();
                } else if (drawingPoints.length <= 1) {
                    if (drawingLine) {
                        map.removeLayer(drawingLine);
                        drawingLine = null;
                    }
                }
                
                // æ›´æ–°åˆ—è¡¨
                updateDrawingPointList();
                
                // æ›´æ–°è·¯å¾‘é è¦½é¢æ¿
                updatePathPreviewPanel();
                
                // ä¿å­˜æ›´æ”¹
                saveToLocalStorage();
            }
        }
        
        function toggleDrawingMode() {
            if (isDrawingMode) {
                finishDrawing();
            } else {
                startDrawing();
            }
        }
        
        // ==================== æ‰¹é‡æ“ä½œåŠŸèƒ½ ====================
        function addAllLocationsToPath() {
            if (locations.length === 0) {
                alert('æš«ç„¡åœ°é»å¯åŠ å…¥');
                return;
            }
            
            let addedCount = 0;
            locations.forEach(location => {
                addDrawingPoint(location.lat, location.lng);
                addedCount++;
            });
            
            if (addedCount > 0) {
                alert(getTranslation('all-locations-added'));
            }
        }
        
        function reversePath() {
            if (drawingPoints.length < 2) {
                alert('è·¯å¾‘é»ä¸è¶³ï¼Œç„¡æ³•åè½‰');
                return;
            }
            
            // åè½‰ç¹ªè£½é»é™£åˆ—
            drawingPoints.reverse();
            
            // åè½‰ç¹ªè£½æ¨™è¨˜é™£åˆ—
            drawingMarkers.reverse();
            
            // æ›´æ–°åˆ—è¡¨å’Œç·šæ¢
            updateDrawingPointList();
            updateDrawingLine();
            
            // ä¿å­˜æ›´æ”¹
            saveToLocalStorage();
            
            alert(getTranslation('path-reversed'));
        }
        
        // ==================== è·¯å¾‘æ•¸æ“šå°å‡ºåŠŸèƒ½ ====================
        function exportPathData(format = 'gpx') {
            if (drawingPoints.length < 2) {
                alert('è«‹å…ˆç¹ªè£½è‡³å°‘å…©å€‹é»çš„è·¯å¾„');
                return;
            }
            
            let data = '';
            let filename = '';
            let contentType = '';
            
            switch(format) {
                case 'gpx':
                    data = generateGPX(drawingPoints);
                    filename = `path_${new Date().getTime()}.gpx`;
                    contentType = 'application/gpx+xml';
                    break;
                case 'kml':
                    data = generateKML(drawingPoints);
                    filename = `path_${new Date().getTime()}.kml`;
                    contentType = 'application/vnd.google-earth.kml+xml';
                    break;
                case 'geojson':
                    data = generateGeoJSON(drawingPoints);
                    filename = `path_${new Date().getTime()}.geojson`;
                    contentType = 'application/geo+json';
                    break;
                default:
                    data = JSON.stringify(drawingPoints, null, 2);
                    filename = `path_${new Date().getTime()}.json`;
                    contentType = 'application/json';
            }
            
            downloadFile(data, filename, contentType);
            alert(getTranslation('export-success'));
        }
        
        function generateGPX(points) {
            let gpx = `<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="åœ˜çµå°éšŠé›»å­åœ°åœ–" xmlns="http://www.topografix.com/GPX/1/1">
  <trk>
    <name>è‡ªå®šç¾©è·¯å¾‘</name>
    <desc>ç”±åœ˜çµå°éšŠé›»å­åœ°åœ–ç”Ÿæˆ</desc>
    <trkseg>`;
            
            points.forEach(point => {
                gpx += `
      <trkpt lat="${point.lat}" lon="${point.lng}">
        <ele>0</ele>
        <time>${new Date().toISOString()}</time>
      </trkpt>`;
            });
            
            gpx += `
    </trkseg>
  </trk>
</gpx>`;
            
            return gpx;
        }
        
        function generateKML(points) {
            let kml = `<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>
    <name>è‡ªå®šç¾©è·¯å¾‘</name>
    <description>ç”±åœ˜çµå°éšŠé›»å­åœ°åœ–ç”Ÿæˆ</description>
    <Placemark>
      <LineString>
        <extrude>1</extrude>
        <tessellate>1</tessellate>
        <coordinates>`;
            
            points.forEach(point => {
                kml += `${point.lng},${point.lat},0 `;
            });
            
            kml += `</coordinates>
      </LineString>
    </Placemark>
  </Document>
</kml>`;
            
            return kml;
        }
        
        function generateGeoJSON(points) {
            const geojson = {
                type: "FeatureCollection",
                features: [{
                    type: "Feature",
                    geometry: {
                        type: "LineString",
                        coordinates: points.map(p => [p.lng, p.lat])
                    },
                    properties: {
                        name: "è‡ªå®šç¾©è·¯å¾‘",
                        created: new Date().toISOString(),
                        points: points.length,
                        creator: "åœ˜çµå°éšŠé›»å­åœ°åœ–"
                    }
                }]
            };
            
            return JSON.stringify(geojson, null, 2);
        }
        
        function downloadFile(content, filename, contentType) {
            const blob = new Blob([content], { type: contentType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        // ==================== è·¯å¾‘é è¦½é¢æ¿åŠŸèƒ½ ====================
        function togglePathPreviewPanel() {
            const panel = document.getElementById('pathPreviewPanel');
            if (panel) {
                panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
                if (panel.style.display === 'block') {
                    updatePathPreviewPanel();
                }
            }
        }
        
        function updatePathPreviewPanel() {
            const statsPanel = document.getElementById('pathPreviewStats');
            
            if (!statsPanel) return;
            
            // æ›´æ–°è·¯å¾‘çµ±è¨ˆ
            statsPanel.innerHTML = '';
            
            const stats = [
                { value: drawingPoints.length, label: 'ç¸½é»æ•¸' },
                { value: calculatePathLength().toFixed(2), label: 'è·¯å¾‘é•·åº¦(km)' }
            ];
            
            stats.forEach(stat => {
                const statElement = document.createElement('div');
                statElement.className = 'path-preview-stat';
                statElement.innerHTML = `
                    <div class="path-preview-stat-value">${stat.value}</div>
                    <div class="path-preview-stat-label">${stat.label}</div>
                `;
                statsPanel.appendChild(statElement);
            });
        }
        
        function calculatePathLength() {
            if (drawingPoints.length < 2) return 0;
            
            let totalDistance = 0;
            for (let i = 0; i < drawingPoints.length - 1; i++) {
                const point1 = drawingPoints[i];
                const point2 = drawingPoints[i + 1];
                
                const R = 6371; // åœ°çƒåŠå¾‘ï¼Œå–®ä½ï¼šå…¬é‡Œ
                const dLat = (point2.lat - point1.lat) * Math.PI / 180;
                const dLon = (point2.lng - point1.lng) * Math.PI / 180;
                const a = 
                    Math.sin(dLat/2) * Math.sin(dLat/2) +
                    Math.cos(point1.lat * Math.PI / 180) * Math.cos(point2.lat * Math.PI / 180) * 
                    Math.sin(dLon/2) * Math.sin(dLon/2);
                const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
                const distance = R * c;
                
                totalDistance += distance;
            }
            
            return totalDistance;
        }
        
        // ==================== å°å‡ºé¸é …åŠŸèƒ½ ====================
        function toggleExportOptions() {
            const exportOptions = document.getElementById('exportOptions');
            if (exportOptions) {
                exportOptions.classList.toggle('show');
            }
        }
        
        // ==================== ç³»çµ±è³‡è¨Šæ›´æ–° ====================
        function updateSystemInfo() {
            const statLocations = document.getElementById('stat-locations');
            if (statLocations) {
                statLocations.textContent = locations.length;
            }
        }
        
        // ==================== è¨­å®šåŠŸèƒ½ ====================
        function applyAllSettings() {
            alert(getTranslation('settings-applied'));
            saveSettings();
        }
        
        function resetAllSettings() {
            if (confirm(getTranslation('confirm-reset'))) {
                mapSettings = {
                    language: 'zh-TW',
                    theme: 'light'
                };
                
                updateInterfaceText('zh-TW');
                updateTeamDisplay();
                saveSettings();
                
                alert(getTranslation('settings-reset'));
            }
        }
        
        function saveSettings() {
            localStorage.setItem('myTravelMapSettings', JSON.stringify(mapSettings));
        }
        
        // ==================== æ•™å­¸åŠŸèƒ½ ====================
        function showTutorial() {
            const tutorialPanel = document.getElementById('tutorialPanel');
            const overlay = document.getElementById('tutorialOverlay');
            
            // å‰µå»ºæ•™å­¸å…§å®¹
            createTutorialContent();
            
            // é¡¯ç¤ºæ•™å­¸é¢æ¿å’Œé®ç½©
            tutorialPanel.style.display = 'block';
            overlay.style.display = 'block';
        }
        
        function createTutorialContent() {
            const tutorialContent = document.getElementById('tutorial-content');
            const t = translations[mapSettings.language] || translations['zh-TW'];
            
            tutorialContent.innerHTML = `
                <div style="padding: 20px;">
                    <h3 style="margin-bottom: 15px; color: var(--primary-color);">${t['tutorial-title']}</h3>
                    
                    <div style="margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #eee;">
                        <h4 style="color: var(--accent-color); margin-bottom: 10px;">${t['tutorial-step1-title']}</h4>
                        <p style="line-height: 1.6;">${t['tutorial-step1-desc']}</p>
                    </div>
                    
                    <div style="margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #eee;">
                        <h4 style="color: var(--accent-color); margin-bottom: 10px;">${t['tutorial-step2-title']}</h4>
                        <p style="line-height: 1.6;">${t['tutorial-step2-desc']}</p>
                    </div>
                    
                    <div style="margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #eee;">
                        <h4 style="color: var(--accent-color); margin-bottom: 10px;">${t['tutorial-step3-title']}</h4>
                        <p style="line-height: 1.6;">${t['tutorial-step3-desc']}</p>
                    </div>
                    
                    <div style="margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #eee;">
                        <h4 style="color: var(--accent-color); margin-bottom: 10px;">${t['tutorial-step4-title']}</h4>
                        <p style="line-height: 1.6;">${t['tutorial-step4-desc']}</p>
                    </div>
                    
                    <div>
                        <h4 style="color: var(--accent-color); margin-bottom: 10px;">${t['tutorial-step5-title']}</h4>
                        <p style="line-height: 1.6;">${t['tutorial-step5-desc']}</p>
                    </div>
                </div>
            `;
        }
        
        function closeTutorial() {
            document.getElementById('tutorialPanel').style.display = 'none';
            document.getElementById('tutorialOverlay').style.display = 'none';
        }
        
        // ==================== å„²å­˜èˆ‡è¼‰å…¥ ====================
        function saveToLocalStorage() {
            try {
                const saveData = {
                    locations: locations,
                    drawingPoints: drawingPoints,
                    timestamp: new Date().getTime(),
                    version: '2.0.0'
                };
                
                // ä½¿ç”¨å£“ç¸®æ¸›å°‘å„²å­˜ç©ºé–“
                const compressedData = LZString.compressToUTF16(JSON.stringify(saveData));
                localStorage.setItem('myTravelMapData', compressedData);
                
                // ä¿å­˜è¨­å®š
                localStorage.setItem('myTravelMapSettings', JSON.stringify(mapSettings));
                
                // æ·»åŠ ç‰ˆæœ¬æ§åˆ¶
                localStorage.setItem('myTravelMapVersion', '2.0.0');
                localStorage.setItem('myTravelMapLastSave', new Date().toISOString());
                
            } catch (error) {
                console.error('å„²å­˜å¤±æ•—:', error);
            }
        }
        
        function loadFromLocalStorage() {
            try {
                const savedData = localStorage.getItem('myTravelMapData');
                const savedSettings = localStorage.getItem('myTravelMapSettings');
                
                if (savedData) {
                    // è§£å£“ç¸®æ•¸æ“š
                    const decompressedData = LZString.decompressFromUTF16(savedData);
                    if (decompressedData) {
                        const parsedData = JSON.parse(decompressedData);
                        if (Array.isArray(parsedData.locations) && parsedData.locations.length > 0) {
                            locations = parsedData.locations;
                        }
                        if (parsedData.drawingPoints) {
                            drawingPoints = parsedData.drawingPoints;
                            // é‡æ–°å‰µå»ºç¹ªè£½é»æ¨™è¨˜
                            recreateDrawingMarkers();
                            updateDrawingPointList();
                            if (drawingPoints.length > 1) {
                                updateDrawingLine();
                            }
                        }
                    }
                }
                
                if (savedSettings) {
                    mapSettings = JSON.parse(savedSettings);
                }
            } catch (error) {
                console.error('è¼‰å…¥å¤±æ•—:', error);
            }
        }
        
        function recreateDrawingMarkers() {
            // æ¸…é™¤ç¾æœ‰çš„ç¹ªè£½æ¨™è¨˜
            drawingMarkers.forEach(marker => {
                map.removeLayer(marker);
            });
            drawingMarkers = [];
            
            // é‡æ–°å‰µå»ºç¹ªè£½æ¨™è¨˜
            drawingPoints.forEach(point => {
                const marker = L.marker([point.lat, point.lng], {
                    icon: L.divIcon({
                        html: '<div style="background-color: #9b59b6; width: 15px; height: 15px; border-radius: 50%; border: 2px solid white; box-shadow: 0 0 5px rgba(0,0,0,0.5);"></div>',
                        className: 'drawing-marker',
                        iconSize: [19, 19],
                        iconAnchor: [9, 9]
                    })
                }).addTo(map);
                drawingMarkers.push(marker);
            });
        }
        
        // ==================== é é¢è¼‰å…¥æ™‚åˆå§‹åŒ– ====================
        window.onload = initApp;
        
        // é»æ“Šé é¢å…¶ä»–å€åŸŸé—œé–‰å°å‡ºé¸é …
        document.addEventListener('click', function(event) {
            const exportOptions = document.getElementById('exportOptions');
            const quickExport = document.getElementById('quick-export');
            
            if (exportOptions && quickExport) {
                if (!exportOptions.contains(event.target) && !quickExport.contains(event.target)) {
                    exportOptions.classList.remove('show');
                }
            }
        });
    </script>
    
    <!-- Google Analytics (å¯é¸) -->
    <!-- 
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-XXXXXXXXXX');
    </script>
    -->
</body>
</html>
